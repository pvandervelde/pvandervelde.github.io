<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head> 
    <!-- Standard Meta -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width" />

    <!-- Site Properities -->
    <title>Mind Vortex</title>
    <meta name="description" content="The place where I ramble on about software development, fluid dynamics, flying and climbing." />
    <meta name="keywords" content="Patrick van der Velde, Petrik, Nuclei, Sherlock, nAnicitus, nAdoni, nTreva, Fluid dynamics, CFD, rock climbing, paragliding" />
    <meta name="author" content="Petrik van der Velde" />

    <!-- DocPad Meta -->
    <meta name="generator" content="DocPad v6.57.3" />

    <!-- DocPad Styles + Our Own -->
    <style >html.wait {
	cursor: wait !important;
	opacity: 0;
	transition: opacity 0.5s ease;
}</style><link  rel="stylesheet" href="/vendor/normalize.css" /><link  rel="stylesheet" href="/vendor/h5bp.css" /><link  rel="stylesheet" href="/styles/style.css" /><link  rel="stylesheet" href="/styles/github.css" />

    <!-- Icons -->
    <!-- Favicon -->
    <link rel="shortcut icon" href="/icons/favicon.ico" />
    
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
</head>
<body>
    <!--[if lt IE 7]>
        <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
    <![endif]-->
    
    <div id="header" class="container">
        <div id="logo">
            <h1><a href="/">Mind Vortex</a></h1>
        </div>
        <div id="menu">
            <ul>
                
                    <li class="inactive">
                        
                            <a href="/index.html">Home</a>
                        
                    </li>
                
                    <li class="inactive">
                        
                            <a href="/projects.html">Projects</a>
                        
                    </li>
                
                    <li class="inactive">
                        
                            <a href="/about.html">About</a>
                        
                    </li>
                
            </ul>
        </div>
    </div>
    <div id="page" class="container">
        <div id="sidebar">
            <div id="sbox1">
                <h2 id="patrick-van-der-velde">Patrick van der Velde</h2>
<p><img src="http://www.gravatar.com/avatar/9bc8b3ff385cd14f2b12138c97729df2?s=160" alt="Gravatar for Patrick van der Velde"> </p>
<p>Dutch software developer, living, working and playing in New Zealand. 
Rock climber, and future paragliding pilot. Developer of <a href="http://pvandervelde.github.io/Sherlock">Sherlock</a>, 
<a href="http://pvandervelde.github.io/Nuclei">Nuclei</a> and other projects</p>
<p><a href="/about.html">More ...</a></p>

            </div>
            <div id="sbox2">
                <h2>Recent</h2>
                <ul>
                    
                        <li><a href="/posts/2014-03-31_Regression-testing-gui-applications.html">GUI testing with TestStack.White</a></li>
                    
                        <li><a href="/posts/2014-02-18_Regression-testing-console-applications.html">Regression testing of a console application</a></li>
                    
                        <li><a href="/posts/2014-01-31_PG2-Site-number-five.html">PG2 - Site number five</a></li>
                    
                        <li><a href="/posts/2014-01-21_PG2-Christmas-holiday-antics.html">PG2 - Christmas holiday antics</a></li>
                    
                        <li><a href="/posts/2014-01-13_Integrating-Sherlock-with-a-build-server.html">Sherlock configuration - Build server integration</a></li>
                    
                        <li><a href="/posts/2013-12-27_Sherlock-Release-V0480.html">Sherlock release - V0.4.8.0</a></li>
                    
                        <li><a href="/posts/2013-12-24_Setting-up-Sherlock-verification.html">Sherlock configuration - Verification</a></li>
                    
                        <li><a href="/posts/2013-12-22_nAnicitus-Release-V0140.html">nAnicitus release - V0.1.4.0</a></li>
                    
                        <li><a href="/posts/2013-12-21_Nuclei-Release-V0710.html">Nuclei release - V0.7.1.0</a></li>
                    
                        <li><a href="/posts/2013-12-11_Setting-up-Sherlock-virtualmachines.html">Sherlock configuration - Virtual machines</a></li>
                    
                </ul>
            </div>
            <div id="sbox3">
                <h2>Tags</h2>
                
                    <a href="/tags/Blog.html" style="font-size: 113.51190772136599%">
                        Blog
                    </a>
                
                    <a href="/tags/Writing.html" style="font-size: 100%">
                        Writing
                    </a>
                
                    <a href="/tags/Paragliding.html" style="font-size: 137.93272064796494%">
                        Paragliding
                    </a>
                
                    <a href="/tags/PG2.html" style="font-size: 142.83173410313947%">
                        PG2
                    </a>
                
                    <a href="/tags/Sherlock.html" style="font-size: 150%">
                        Sherlock
                    </a>
                
                    <a href="/tags/DocPad.html" style="font-size: 100%">
                        DocPad
                    </a>
                
                    <a href="/tags/GitHub.html" style="font-size: 100%">
                        GitHub
                    </a>
                
                    <a href="/tags/nRefs.html" style="font-size: 100%">
                        nRefs
                    </a>
                
                    <a href="/tags/Nuclei.html" style="font-size: 131.37367815376516%">
                        Nuclei
                    </a>
                
                    <a href="/tags/Climbing.html" style="font-size: 100%">
                        Climbing
                    </a>
                
                    <a href="/tags/Waipapa.html" style="font-size: 100%">
                        Waipapa
                    </a>
                
                    <a href="/tags/nAnicitus.html" style="font-size: 121.41586705156973%">
                        nAnicitus
                    </a>
                
                    <a href="/tags/nAdoni.html" style="font-size: 113.51190772136599%">
                        nAdoni
                    </a>
                
                    <a href="/tags/Symbol-server.html" style="font-size: 100%">
                        Symbol server
                    </a>
                
                    <a href="/tags/SymStore.html" style="font-size: 100%">
                        SymStore
                    </a>
                
                    <a href="/tags/PDB.html" style="font-size: 100%">
                        PDB
                    </a>
                
                    <a href="/tags/Regression-test.html" style="font-size: 100%">
                        Regression test
                    </a>
                
                    <a href="/tags/Jenkins.html" style="font-size: 100%">
                        Jenkins
                    </a>
                
                    <a href="/tags/TeamCity.html" style="font-size: 100%">
                        TeamCity
                    </a>
                
                    <a href="/tags/MsBuild.html" style="font-size: 100%">
                        MsBuild
                    </a>
                
                    <a href="/tags/Regression-testing.html" style="font-size: 113.51190772136599%">
                        Regression testing
                    </a>
                
                    <a href="/tags/Console.html" style="font-size: 100%">
                        Console
                    </a>
                
                    <a href="/tags/Apollo.html" style="font-size: 113.51190772136599%">
                        Apollo
                    </a>
                
                    <a href="/tags/Scripting.html" style="font-size: 100%">
                        Scripting
                    </a>
                
                    <a href="/tags/UI-test.html" style="font-size: 100%">
                        UI test
                    </a>
                
                    <a href="/tags/TestStack-White.html" style="font-size: 100%">
                        TestStack.White
                    </a>
                
            </div>
        </div>
        <div id="content">
            <div id="posts">
    <h3 id="post-tags-header">Posts tagged with: Apollo</h3>
    
        <div id="post-spacer">
            <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2014-03-31_Regression-testing-gui-applications.html'>GUI testing with TestStack.White</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Monday, March 31, 2014 | Posted in
                
                    <a id="post-category" href="/tags/Regression testing.html">Regression testing</a>
                
                    <a id="post-category" href="/tags/UI test.html">UI test</a>
                
                    <a id="post-category" href="/tags/TestStack.White.html">TestStack.White</a>
                
                    <a id="post-category" href="/tags/Apollo.html">Apollo</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>In the <a href="/posts/2014-02-18_Regression-testing-console-applications.html">previous</a> post I explained how I created the regression tests for a script running application that belongs to the <a href="/projects/apollo.html">Apollo</a> project. In this post I will explain how I created the regression tests for an Apollo application with a graphical user interface (UI).</p>
<p>My initial attempt to write a regression test suite for the GUI application was done using the <a href="http://www.nunit.org/">NUnit</a> and <a href="http://scriptcs.net/">ScriptCS</a> with the idea that NUnit would provide the test execution and validation methods and ScriptCs would provide an easy way to write the test scripts without requiring a complete IDE to be used. After some trial-and-error it became clear that this approach was not the most suitable solution for the following reasons:</p>
<ul>
<li>Using NUnit, or any unit test framework for that matter, complicated things because there is no way to take control of the order in which the regression tests are executed. While the ordering of unit tests is irrelevant, the ordering of regression tests may not be in that it is accepted that regression tests involve the execution multiple, ordered tests for one single activation of the application under test (AUT).</li>
<li>A secondary drawback of using a unit test framework is that there is normally no way to re-run a test case if it fails, something which is more acceptable for a regression test than for a unit test.</li>
<li>The test code got rather complicated due to the many helper methods, script files etc.. While ScriptCs coped beautifully with this it turned out to hard for me to work with without the organizing features of a complete IDE.</li>
</ul>
<p>In the end I wrote a custom (console) application that handles the ordering and execution of the different test cases in the way that makes sense for my current requirements.</p>
<h4 id="testing-application">Testing application</h4>
<p>The testing application executes the tests, collects the results and logs all the outputs. When executing the tests each test is executed a maximum of three times before it is marked as a fail. The following code is used by the application to execute the test steps and to keep track of the number of times a test step is executed. </p>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_ExecuteTestStep.cs'></script>

<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_TestStep.cs'></script>

<p>The reason for having multiple attempts to complete a test is that the nature of the GUI automation testing is that it is not completely <a href="http://www.mathpirate.net/log/2009/12/23/ui-automation-tricks-and-traps/">consistent</a>. By allowing a test to fail twice it is possible to work around the problem of inconsistent handling of controls.</p>
<p>The second part of the application keeps track of the test results while the tests are running. The application will always try to execute all the tests, irrespective of their final success or failure. That way the user will always have a complete report of the state of all the tests.</p>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_EntryPoint.cs'></script>

<p>Finally the application provides utility methods for logging which should be used liberally by both the application and the test steps.</p>
<h4 id="tests">Tests</h4>
<p>In order for the tests to interact with the GUI I chose to use the <a href="https://github.com/TestStack/White">TestStack.White</a> library mainly because it is a mature open source library that has a number of active contributors. One thing to keep in mind when selecting a GUI automation library is that the <a href="http://en.wikipedia.org/wiki/Microsoft_UI_Automation">underlying technology</a> has some tricky hooks to it that cannot be completely hidden by the automation library. One example is that all controls can be found based on their <a href="http://msdn.microsoft.com/en-us/library/aa349646%28v=vs.110%29.aspx">automation ID</a> but windows cannot, even if the window in question has an automation ID.</p>
<p>The main piece of advice for writing UI automation tests is always to write some helper methods to hide the underlying complexity of the UI access technology. In my case I took the following steps:  </p>
<ul>
<li>Control very carefully how your helper methods return information to the caller, either through a return value or through exceptions. In my case if a helper method returns a value it should either return the requested object or null if it fails to get the requested object. The calling code should then always check for null and handle the case of a null return value, e.g. by retrying the method call. The only time the method will throw an exception is if the assumed conditions for the method are wrong, e.g. the application under test (AUT) has crashed. If the helper method has no return value then it may throw if it fails to execute.</li>
</ul>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_HelpersForMenu.cs'></script>

<ul>
<li>All actions that get a control will try to get the control several times if they fail. Due to the nature of UI automation it is possible that the control is not available the first time the code tries to get hold of the control. This may be due tot he fact that the automation tests are fast enough that they try to get the control in the 0.1 second that the control is not available yet. Note that this also makes for some very tricky debugging which requires a decent amount of logging. </li>
</ul>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_Retry.cs'></script>

<p>Note that automation tests are usually linked strongly to a specific version of the software because the tests assume the availability of certain automation IDs and controls. Some parts are implicitly linked and others can be, but don&#39;t have to be, explicitly linked. Examples are: </p>
<ul>
<li>The application, product and company names can be shared through a configuration or shared code file:</li>
</ul>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_CompanyInformation.cs'></script>

<ul>
<li>Automation IDs can be shared via a shared code file. Note that application ID names should be pointing to a given area / functionality, not specific controls (Also note that in my case that&#39;s not always done the right way):</li>
</ul>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_AutomationID.cs'></script>

<script src='https://gist.github.com/9202656.js?file=Apollo_Explorer_MenuView.xaml'></script>

<p>When executing the tests it is a good idea to reset your application state either at the end of each test or at the start of each test. Or even better both to make sure that you always start a test from the same state irrespective of the way the previous test ended, e.g. with an application crash.</p>
<p>Finally do not give up if you find it hard to make the tests reliable. By continually improving the robustness of the test code eventually the tests will start to behave in the way you expect them too. Some <a href="http://www.mathpirate.net/log/2009/12/23/ui-automation-tricks-and-traps/">tricks and hacks</a> that I found necessary are:</p>
<ul>
<li>Time-outs while getting controls, setting values on controls or getting values from controls. While these are ugly they are sometimes necessary.</li>
<li>For each test restart the application if at all possible so that you end up with a known application state. This will improve the repeatability of the tests. Note that if the application is slow to start up then you can either improve the start up performance of the application or if that is not possible then carefully combine tests but be aware that tests may fail due to polluted application state. </li>
<li>Note that some application state survives restarts, e.g. user and application settings. It would be good if you have a way of resetting that state in a relatively sure-fire way. This is something I have not implemented yet though.</li>
</ul>
<p>And then the last comment must be that the development of these tests has been much more complicated than I thought it would be. The approach I used required some coding skills so this may or may not be suitable in other situations depending on the skill sets of the testers or developers.</p>
 
    </div>
</div>
        </div>
    
        <div id="post-spacer">
            <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2014-02-18_Regression-testing-console-applications.html'>Regression testing of a console application</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Tuesday, February 18, 2014 | Posted in
                
                    <a id="post-category" href="/tags/Regression testing.html">Regression testing</a>
                
                    <a id="post-category" href="/tags/Console.html">Console</a>
                
                    <a id="post-category" href="/tags/Apollo.html">Apollo</a>
                
                    <a id="post-category" href="/tags/Scripting.html">Scripting</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>After <a href="/posts/2013-12-04_Regression-testing-with-Sherlock.html">setting up</a> <a href="https://github.com/pvandervelde/Sherlock">Sherlock</a> you will need to create some tests that you can execute with Sherlock. In this post I will describe how I created the regression tests for the command line application of <a href="/projects/apollo.html">Apollo</a>.</p>
<p>For this case the application-under-test (AUT) is the Apollo console application which provides the user with a way to control the capabilities of Apollo, e.g. running a fluid dynamics simulation, by executing a Python script. The goal of the regression test for the console application is to execute a large part of the API which is used by scripts to interact with the different parts of Apollo.</p>
<p>In order to test the scripting API I wrote several scripts that will be executed during the test. Each script exercises several parts of the API and checks after each action that the state of the application is as expected. An example of a test script is given in the following code segment:</p>
<script src='https://gist.github.com/8995251.js'></script>

<p>This test script:</p>
<ol>
<li>Verifies that no project exists at start-up. If one exists the test is considered failed and the script forces the application to exit with a non-zero exit code.</li>
<li>Creates a new project and obtains a reference to the new project. If either step fails then once again the application is forced to exit with a non-zero exit code.</li>
<li>The name of the project is changed and the script verifies that the new name has been stored.</li>
</ol>
<p>Obviously the script given here is a rather trivial and somewhat naive test script however it does provide an idea of what a test script should do.</p>
<p>In order to inform Sherlock that the script execution has failed the script can either write to the error stream or it can force the application to exit with a non-zero error code. To provide data for fault analysis a test script can write to both the standard output stream and the error data stream. Information gathered from either stream will be placed in the Sherlock log, which can be copied back to the report location by setting the correct switches. Additionally any data on the error stream will be written to the test report.</p>
<p>It is important to note that the test script should be robust enough to handle any kind of problem encountered because there is no guarantee that the application will behave in the appropriate manner, after all the application is being tested to see if it is fit for purpose.</p>
<p>Once the test scripts are written you can create a test configuration for the different test steps. An example is given below:</p>
<script src='https://gist.github.com/8995455.js'></script>

<p>The important things to note in this configuration are:</p>
<ul>
<li>Each test step copies back the system log files which include:<ul>
<li>The Sherlock log file written on the test environment.</li>
<li>Any MSI install log files.</li>
</ul>
</li>
<li>The test script executing test step also copies the log files written by the console application.</li>
</ul>
 
    </div>
</div>
        </div>
    
</div>
        </div>
    </div>
    <div id="footer" class="container">
        <div id="fbox1">
            <h2>Related</h2>

<ul>
    <li id="first"><a href="https://github.com/pvandervelde">GitHub</a></li>
    <li><a href="http://www.linkedin.com/profile/view?id=33950311">LinkedIn</a></li>
    <li><a href="http://stackoverflow.com/users/539846/petrik">StackOverflow</a></li>
    <li><a href="http://careers.stackoverflow.com/pvandervelde">StackOverflow Careers</a></li>
</ul>
        </div>
        <div id="fbox2">
            <h2 id="copyright">Copyright</h2>
<p>Copyright (c) 2013 <a href="http://pvandervelde.github.io">http://pvandervelde.github.io</a>. All rights reserved.</p>
<h2 id="disclaimer">Disclaimer</h2>
<p>The opinions expressed herein are my own personal opinions and do not represent my employer&#39;s view in any way.</p>

        </div>
        <div id="fbox3">
            <h2 id="media">Media</h2>
<p><a href="/atom.xml"><img src="/images/feed.png" alt="Atom feed"></a></p>

        </div>
    </div>
    <div id="copyright" class="container">
        <p>
            Site design based on the <a href="http://www.freecsstemplates.org/previews/opentools/">Open Tools</a> design 
            by <a href="http://www.freecsstemplates.org">FreeCSSTemplates.org</a>. Feed icon by <a href="http://www.icojam.com/">Icojam</a>.
        </p>
        <p>Generated by <a href="http://docpad.org/" rel="nofollow">DocPad</a> on Monday, March 31, 2014.</p>
    </div>

    <!-- jQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/vendor/jquery.js"><\/script>')</script>

    <!-- DocPad Scripts + Our Own -->
    <script >(function(){
	/* Did we just livereload? */
var log = !!(localStorage && console && console.log && true);
if ( log && localStorage.getItem('/docpad-livereload/reloaded') === 'yes' ) {
	localStorage.removeItem('/docpad-livereload/reloaded');
	console.log('LiveReload completed at', new Date())
}

/* Listen for the regenerated event and perform a reload of the page when the event occurs */
var listen = function(){
	var primus = new Primus('/docpad-livereload');
	primus.on('data', function(data){
		if ( data && data.message ) {
			if ( data.message === 'generateBefore' ) {
				if ( log ) {
					console.log('LiveReload started at', new Date());
				}
				if ( typeof document.getElementsByTagName !== 'undefined' ) {
	document.getElementsByTagName('html')[0].className += ' wait';
}
			}
			else if ( data.message === 'generateAfter' ) {
				if ( log ) {
					localStorage.setItem('/docpad-livereload/reloaded', 'yes');
				}
				document.location.reload();
			}
		}
	});
};
	/* Inject socket into our page */
var inject = function(){
	var t = document.createElement('script');
	t.type = 'text/javascript';
	t.async = 'async';
	t.src = '/primus/primus.js';
	t.onload = listen;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(t, s);
};
	if ( typeof Primus !== 'undefined' ) {
		listen();
	} else {
		inject();
	}
})();</script><script >var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-46605109-1']);
_gaq.push(['_trackPageview']);
(function(){
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script><script defer="defer"  src="/vendor/log.js"></script><script defer="defer"  src="/vendor/modernizr.js"></script><script defer="defer"  src="/scripts/script.js"></script>
</body>
</html>