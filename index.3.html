<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head> 
    <!-- Standard Meta -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width" />

    <!-- Site Properities -->
    <title>Home | Mind Vortex</title>
    <meta name="description" content="The place where I ramble on about software development, fluid dynamics, flying and climbing." />
    <meta name="keywords" content="Patrick van der Velde, Petrik, Nuclei, Sherlock, nAnicitus, nAdoni, nTreva, rock climbing, paragliding" />
    <meta name="author" content="Petrik van der Velde" />

    <!-- DocPad Meta -->
    <meta name="generator" content="DocPad v6.65.0" />

    <!-- DocPad Styles + Our Own -->
    <style >html.wait {
	cursor: wait !important;
	opacity: 0;
	transition: opacity 0.5s ease;
}</style><link  rel="stylesheet" href="/vendor/normalize.css" /><link  rel="stylesheet" href="/vendor/h5bp.css" /><link  rel="stylesheet" href="/styles/style.css" /><link  rel="stylesheet" href="/styles/github.css" />

    <!-- Icons -->
    <!-- Favicon -->
    <link rel="shortcut icon" href="/icons/twister.ico" />
    
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
</head>
<body>
    <!--[if lt IE 7]>
        <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
    <![endif]-->
    
    <div id="header" class="container">
        <div id="logo">
            <h1><a href="/">Mind Vortex</a></h1>
        </div>
        <div id="menu">
            <ul>
                
                    <li class="inactive">
                        
                            <a href="/index.html">Home</a>
                        
                    </li>
                
                    <li class="inactive">
                        
                            <a href="/projects.html">Projects</a>
                        
                    </li>
                
                    <li class="inactive">
                        
                            <a href="/archives.html">Archives</a>
                        
                    </li>
                
                    <li class="inactive">
                        
                            <a href="/about.html">About</a>
                        
                    </li>
                
            </ul>
        </div>
    </div>
    <div id="page" class="container">
        <div id="sidebar">
            <div id="sbox1">
                <h2 id="patrick-van-der-velde">Patrick van der Velde</h2>
<p><img src="http://www.gravatar.com/avatar/9bc8b3ff385cd14f2b12138c97729df2?s=160" alt="Gravatar for Patrick van der Velde"> </p>
<p>Dutch software developer, living, working and playing in New Zealand. 
Rock climber, and future paragliding pilot. Developer of <a href="http://pvandervelde.github.io/Sherlock">Sherlock</a>, 
<a href="http://pvandervelde.github.io/Nuclei">Nuclei</a> and other projects</p>
<p><a href="/about.html">More ...</a></p>

            </div>
            <div id="sbox2">
                <h2>Recent</h2>
                <ul>
                    
                        <li><a href="/posts/2014-09-27_Building-and-delivering-nBuildKit-with-AppVeyor.html">Building and delivering nBuildKit with AppVeyor</a></li>
                    
                        <li><a href="/posts/2014-08-19_nBuildKit-release-V032.html">nBuildKit release - V0.3.2</a></li>
                    
                        <li><a href="/posts/2014-07-26_Adding-pagination-with-DocPad.html">Adding pagination with DocPad</a></li>
                    
                        <li><a href="/posts/2014-07-24_Blog-archives-by-DocPad.html">Blog archives by DocPad</a></li>
                    
                        <li><a href="/posts/2014-07-21_nBuildKit-release-V024.html">nBuildKit release - V0.2.4</a></li>
                    
                        <li><a href="/posts/2014-06-16_nBuildKit-release-V015.html">nBuildKit release - V0.1.5</a></li>
                    
                        <li><a href="/projects/nbuildkit.html">nBuildKit</a></li>
                    
                        <li><a href="/posts/2014-05-28_Nuclei-release-V080.html">Nuclei release - V0.8.0</a></li>
                    
                        <li><a href="/posts/2014-05-23_Improvements-to-the-site.html">Improvements to the site</a></li>
                    
                        <li><a href="/projects/nrefs.html">nRefs</a></li>
                    
                </ul>
            </div>
            <div id="sbox3">
                <h2>Tags</h2>
                
                    <a href="/tags/apollo.html" style="font-size: 113.13247675185968%">
                        Apollo
                    </a>
                
                    <a href="/tags/appveyor.html" style="font-size: 100%">
                        AppVeyor
                    </a>
                
                    <a href="/tags/blog.html" style="font-size: 130.49266672559813%">
                        Blog
                    </a>
                
                    <a href="/tags/climbing.html" style="font-size: 100%">
                        Climbing
                    </a>
                
                    <a href="/tags/configuration.html" style="font-size: 100%">
                        Configuration
                    </a>
                
                    <a href="/tags/console.html" style="font-size: 100%">
                        Console
                    </a>
                
                    <a href="/tags/continous-integration.html" style="font-size: 113.13247675185968%">
                        Continous integration
                    </a>
                
                    <a href="/tags/docpad.html" style="font-size: 120.81448319328996%">
                        DocPad
                    </a>
                
                    <a href="/tags/github.html" style="font-size: 100%">
                        GitHub
                    </a>
                
                    <a href="/tags/gitversion.html" style="font-size: 100%">
                        GitVersion
                    </a>
                
                    <a href="/tags/jenkins.html" style="font-size: 120.81448319328996%">
                        Jenkins
                    </a>
                
                    <a href="/tags/job-template.html" style="font-size: 100%">
                        Job template
                    </a>
                
                    <a href="/tags/msbuild.html" style="font-size: 100%">
                        MsBuild
                    </a>
                
                    <a href="/tags/nuclei.html" style="font-size: 150%">
                        Nuclei
                    </a>
                
                    <a href="/tags/pdb.html" style="font-size: 113.13247675185968%">
                        PDB
                    </a>
                
                    <a href="/tags/pg2.html" style="font-size: 141.62896638657992%">
                        PG2
                    </a>
                
                    <a href="/tags/paragliding.html" style="font-size: 136.86752324814032%">
                        Paragliding
                    </a>
                
                    <a href="/tags/regression-test.html" style="font-size: 100%">
                        Regression test
                    </a>
                
                    <a href="/tags/regression-testing.html" style="font-size: 113.13247675185968%">
                        Regression testing
                    </a>
                
                    <a href="/tags/srcsrv.html" style="font-size: 100%">
                        SRCSRV
                    </a>
                
                    <a href="/tags/scripting.html" style="font-size: 100%">
                        Scripting
                    </a>
                
                    <a href="/tags/sherlock.html" style="font-size: 148.59593857014607%">
                        Sherlock
                    </a>
                
                    <a href="/tags/software-delivery.html" style="font-size: 100%">
                        Software delivery
                    </a>
                
                    <a href="/tags/source-server.html" style="font-size: 100%">
                        Source server
                    </a>
                
                    <a href="/tags/symstore.html" style="font-size: 100%">
                        SymStore
                    </a>
                
                    <a href="/tags/symbol-server.html" style="font-size: 100%">
                        Symbol server
                    </a>
                
                    <a href="/tags/symbol-stream.html" style="font-size: 100%">
                        Symbol stream
                    </a>
                
                    <a href="/tags/teamcity.html" style="font-size: 100%">
                        TeamCity
                    </a>
                
                    <a href="/tags/teststack-white.html" style="font-size: 100%">
                        TestStack.White
                    </a>
                
                    <a href="/tags/ui-test.html" style="font-size: 100%">
                        UI test
                    </a>
                
                    <a href="/tags/unc.html" style="font-size: 100%">
                        UNC
                    </a>
                
                    <a href="/tags/wcf.html" style="font-size: 126.26495350371935%">
                        WCF
                    </a>
                
                    <a href="/tags/waipapa.html" style="font-size: 100%">
                        Waipapa
                    </a>
                
                    <a href="/tags/writing.html" style="font-size: 100%">
                        Writing
                    </a>
                
                    <a href="/tags/nadoni.html" style="font-size: 113.13247675185968%">
                        nAdoni
                    </a>
                
                    <a href="/tags/nanicitus.html" style="font-size: 130.49266672559813%">
                        nAnicitus
                    </a>
                
                    <a href="/tags/nbuildkit.html" style="font-size: 126.26495350371935%">
                        nBuildKit
                    </a>
                
                    <a href="/tags/nrefs.html" style="font-size: 100%">
                        nRefs
                    </a>
                
            </div>
        </div>
        <div id="content">
            
    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2013-12-27_Sherlock-Release-V0480.html'>Sherlock release - V0.4.8.0</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Friday, December 27, 2013 | Posted in
                
                    <a id="post-category" href="/tags/sherlock.html">Sherlock</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>Version <a href="https://github.com/pvandervelde/Sherlock/releases/tag/v0.4.8.0">V0.4.8.0</a> of the <a href="/projects/sherlock.html">Sherlock</a> regression testing application has been released. This release provides the following issues:</p>
<ul>
<li><a href="https://github.com/pvandervelde/Sherlock/issues/13">#13</a> - Provide setup verification</li>
<li><a href="https://github.com/pvandervelde/Sherlock/issues/14">#14</a> - Add license and readme to all downloadable files</li>
<li><a href="https://github.com/pvandervelde/Sherlock/issues/15">#15</a> - Include test purpose in final test report</li>
<li><a href="https://github.com/pvandervelde/Sherlock/issues/22">#22</a> - Add NuGet symbols package for easy upload to a symbol server</li>
<li><a href="https://github.com/pvandervelde/Sherlock/issues/23">#23</a> - OutOfMemoryException in Sherlock.Service.Master</li>
<li><a href="https://github.com/pvandervelde/Sherlock/issues/24">#24</a> - Hyper-V: If a virtual machine is running when a new test is started terminate the current run</li>
<li><a href="https://github.com/pvandervelde/Sherlock/issues/26">#26</a> - Hyper-V: Handle state change result code</li>
</ul>
 
    </div>
</div>
    </div>

    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2013-12-24_Setting-up-Sherlock-verification.html'>Sherlock configuration - Verification</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Tuesday, December 24, 2013 | Posted in
                
                    <a id="post-category" href="/tags/sherlock.html">Sherlock</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>After the configuration of the <a href="/posts/2013-12-10_Setting-up-Sherlock-serverside.html">host machine</a> and the <a href="/posts/2013-12-11_Setting-up-Sherlock-virtualmachines.html">virtual machines</a> the final step in the configuration of Sherlock is to verify that everything is configured correctly. This can be done by using the verification package that comes with each <a href="https://github.com/pvandervelde/Sherlock/releases">release</a> of Sherlock. In order to use the verification package take the following steps:</p>
<ul>
<li>Unpack the <strong>verification.zip</strong> package to a directory somewhere (e.g. <code>c:\temp\sherlock</code>).</li>
<li>Update the configuration file <code>Sherlock.VerificationConfiguration.msbuild</code> with the following settings:<ul>
<li><strong>ConfigurationReportDirectory:</strong> The directory where you want the final report to be placed. Note that both the user who requests the test and the user which is used to run the Sherlock services need to have access to this directory. The <code>report</code> directory that was created on the <a href="/posts/2013-12-10_Setting-up-Sherlock-serverside.html">host</a> machine</li>
<li><strong>ConfigurationServerUrl:</strong> The URL of the web service, e.g. <code>http:\\myhostmachine\sherlock.api</code></li>
<li><strong>ConfigurationOperatingSystem:</strong> The operating system name that you want to test with. This needs to match one of the operating systems that has been registered with the management website and which is installed on at least one of your test environments.</li>
<li><strong>ConfigurationOperatingSystemServicePack:</strong> Can be left empty if the operating system has no service pack. If the operating system has a service pack then it needs to match the service pack name of the operating system as registered with the management web site.</li>
<li><strong>ConfigurationOperatingSystemCulture:</strong> The <a href="http://en.wikipedia.org/wiki/IETF_language_tag">culture</a> as defined for the registered operating system.</li>
<li><strong>ConfigurationOperatingSystemPointerSize:</strong> The &#39;bitness&#39; or pointer size for the operating system, either 32 or 64 bits. Should again match the value that was provided when the operating system was registered.</li>
<li><strong>ConfigurationRemotePcWorkingPath:</strong> A path where the test files will be placed on the test environment, e.g. <code>c:\temp</code>.</li>
<li><strong>ConfigurationSherlockConsoleDirectory:</strong> The directory where the console application is installed, this may be a UNC path or a normal directory, e.g. <code>\\MyHostMachine\console</code>.</li>
</ul>
</li>
<li>Execute the <code>Sherlock.ExecuteVerificationTests.msbuild</code> script. This script will prepare the files to be send across (a test application and some test scripts), start the console application, register the test and then wait for the reports to be produced. </li>
</ul>
<p>Note that the reports will come back with some errors. The verification was designed this way on purpose to make it possible to test the error handling. In the end there should be three reports, one for each known test configuration version, i.e. v1.0, v1.1 and v1.2. The reports should show the following errors:</p>
<ul>
<li>The script execution that executes <code>c:\temp\Sherlock.Verification.Console.exe</code> with the <code>-f</code> command line argument. The <code>-f</code> parameter indicates that the process should &#39;fail&#39; and exit with an exit code of 1.</li>
<li>The script execution for <code>c:\temp\Sherlock.Verfication.Console.exe</code> with parameter <code>-c</code>. The <code>-c</code> parameter indicates that the process should exit with an unhandled exception. The exit code for the process should be -532462766.</li>
<li>The application execution <code>c:\temp\Sherlock.Verification.Console.exe</code> with the <code>-f</code> command line argument. </li>
<li>The application execution for <code>c:\temp\Sherlock.Verfication.Console.exe</code> with parameter <code>-c</code>. </li>
</ul>
<h3 id="troubleshooting">Troubleshooting</h3>
<p>If there are any problems during the verification then the first thing to look at are the debug logs which are written by the different applications. The logs are generally found in <code>c:\ProgramData\Sherlock\&lt;APP_NAME&gt;\&lt;VERSION&gt;\logs</code>. Notes:</p>
<ol>
<li>If there is not enough information in the logs then you can change the log level in the application configuration file under the <code>DefaultLogLevel</code> configuration option. The available levels are (from most verbose to least verbose):<ul>
<li>Trace </li>
<li>Debug</li>
<li>Info</li>
<li>Warn</li>
<li>Error</li>
<li>Fatal</li>
<li>None</li>
</ul>
</li>
<li>The applications running in the test environment also log but those logs may be removed if the test environment is a virtual machine. However version 1.2 of the test configuration file has the possibly to copy the logs back to the host machine for inclusion into the test report. For this to work set the <code>includesystemlog</code> attribute of the <code>includeinreport</code> element to <code>true</code>.</li>
</ol>
<p>Some standard problems that may occur are mentioned below.</p>
<h4 id="console-and-web-service">Console and web service</h4>
<ul>
<li>If the console application fails to connect to the web service because it cannot find the web service then verify that the web service can be reached. The two main problems that could be the root cause of this are either the web service is not running or the user which started the console application has no access rights to the web service.</li>
<li>If the console application crashes due to a URL problem (see the log file) then it is most likely that you put a partial URL, e.g. <code>mycoolserver\sherlock.api</code> instead of <code>http://mycoolserver/sherlock.api</code>.</li>
<li>If the console successfully manages to go through nearly all the test registration steps but fails on the transfer of the test files then there is quite likely a problem with the web service permissions to write to the <code>App_Data</code> directory.</li>
<li>If the web service fails on the first call then there is quite likely a problem with the database connection. This is most likley either a problem with the connection string or a problem with the permissions. In case of a permission issue check if the user which is running the web service can access the stored procedures in the database.</li>
</ul>
<h4 id="update-service">Update service</h4>
<ul>
<li>If the update service is unable to verify the update packages then it is not able to access the public key file. Make sure the configuration file points to the public key file and that this file is reachable by the service.</li>
</ul>
<h4 id="master-controller">Master controller</h4>
<ul>
<li>If the master controller fails to connect to the database this could point to either a problem with the connection string or a problem with the permissions. In case of a permissions problem again check that the user running the master controller can access the stored procedures in the database.</li>
<li>If the master controller is unable to start a virtual machine then the <em>SherlockUser</em> may not have <a href="http://blogs.msdn.com/b/virtual_pc_guy/archive/2008/01/17/allowing-non-administrators-to-control-hyper-v.aspx">permissions</a> to start the virtual machines. The log will show this as an error in the environment loading. Probably a security exception.</li>
<li>If the controller is blocked by the firewall, or the firewall on the test environment is blocking, then there will be no communication between the test environment and the host. The log shows this through the fact that the host will wait an excessive amount of time for the remote &#39;endpoint&#39; to connect. A normal start up takes around 2 minutes for a test environment start, operating system load and Sherlock load.</li>
</ul>
 
    </div>
</div>
    </div>

    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2013-12-22_nAnicitus-Release-V0140.html'>nAnicitus release - V0.1.4.0</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Sunday, December 22, 2013 | Posted in
                
                    <a id="post-category" href="/tags/nanicitus.html">nAnicitus</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>Version <a href="https://github.com/pvandervelde/nAnicitus/releases/tag/V0.1.4.0">V0.1.4.0</a> of the <a href="/projects/nanicitus.html">nAnicitus</a> symbol store application has been released. This release fixes issue <a href="https://github.com/pvandervelde/nAnicitus/issues/1">#1</a>. If a package is locked by the operating system, e.g. because the file write has not completed yet, then nAnicitus will try to load the package 3 times, waiting 5 seconds between each try. On top of that if the loading of a package fails then the nAnicitus will retry loading the package 3 times before giving up.</p>
 
    </div>
</div>
    </div>

    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2013-12-21_Nuclei-Release-V0710.html'>Nuclei release - V0.7.1.0</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Saturday, December 21, 2013 | Posted in
                
                    <a id="post-category" href="/tags/nuclei.html">Nuclei</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>Version <a href="https://github.com/pvandervelde/Nuclei/releases/tag/V0.7.1.0">V0.7.1.0</a> of the <a href="/projects/nuclei.html">Nuclei</a> library has been released. This release fixes issue <a href="https://github.com/pvandervelde/Nuclei/issues/9">#9</a>.</p>
 
    </div>
</div>
    </div>

    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2013-12-11_Setting-up-Sherlock-virtualmachines.html'>Sherlock configuration - Virtual machines</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Wednesday, December 11, 2013 | Posted in
                
                    <a id="post-category" href="/tags/sherlock.html">Sherlock</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>After <a href="/posts/2013-12-10_Setting-up-Sherlock-serverside.html">setting up the host machine</a> the next step in the <a href="/posts/2013-12-04_Regression-testing-with-Sherlock.html">configuration</a> of Sherlock is to set up one or more virtual machines. Each virtual machine will have the following applications installed:</p>
<ul>
<li>The update service which handles the installation of the latest available Sherlock binaries. </li>
<li>The executor service which handles the communication with the master controller, handles the download and upload of test files and test reports and controls the test execution. </li>
<li>The application which executes the test steps. This has been separated from the service so that: <ul>
<li>It is possible to run the application on the desktop while the executor service is running as a Windows service.</li>
<li>Any fatal errors in the test application don&#39;t affect the service, thereby maintaining communication with the master controller, and thus allowing error reports to be send.</li>
<li>It is possible to run multiple applications under different accounts (planned in future releases).</li>
</ul>
</li>
</ul>
<p>The configuration process for a virtual machine consists of the following steps:</p>
<ul>
<li>Create a new virtual machine and install the operating system</li>
<li>Configure the operating system on the virtual machine</li>
<li>Install and configure the Sherlock applications on the virtual machine</li>
<li>Store information about the virtual machine in the host database</li>
</ul>
<h3 id="preparing-the-virtual-machine">Preparing the virtual machine</h3>
<p>The first step is to create a <a href="http://technet.microsoft.com/en-us/library/cc772480.aspx">new virtual machine</a> and install the operating system. This should be straight forward but there a few things to look out for:</p>
<ul>
<li>The operating system must (currently) support <a href="http://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.5">.NET 4.5</a> because that is what Sherlock is needs to run on.</li>
<li>The network for the virtual machine must be set up so that it can at the very least see the host machine and the other virtual machines stored on the same host machine.<ul>
<li><strong>Note:</strong> Windows networks can <a href="http://www.petri.co.il/working-with-domain-member-virtual-machines-and-snapshots.htm">deny access</a> to the test virtual machines after being used for a while (usually 30 days) due to the fact that the test machine is reset after each test, thereby not allowing it to handle the renewal of network identification keys correctly.</li>
</ul>
</li>
</ul>
<h3 id="preparing-the-operating-system">Preparing the operating system</h3>
<p>After the creation of the virtual machine and the installation of the operating system it is necessary to configure the operating system. Some of the changes are necessary for Sherlock to function while others are necessary only from a test perspective.</p>
<p>Lets first start with the changes required for Sherlock to function. </p>
<ul>
<li>If .NET 4.5 is not already installed, then install it. Without it Sherlock won&#39;t run at all.</li>
<li>Create a new user that will be used to execute the tests. This user needs to be an administrator so that the execution of an MSI install can succeed without the need for elevation (which is <a href="http://stackoverflow.com/questions/5098121/how-can-i-get-elevated-permissions-uac-via-impersonation-under-a-non-interacti">a bit tricky</a> from an application). The user can be either a machine local administrator or a domain user  which is granted administration rights on the machine.<ul>
<li>Note that there might a difference between a domain user with administrative rights on the computer and a local administrator. If you turn UAC off then in general a local administrator is running all applications elevated while the applications started by the domain user run with no elevation only to be silently elevated if requested to do so. Unfortunately this means that the domain user will not be able to run a silent install from a command line unless that command line is explicitly elevated (which is not possible from an application).</li>
</ul>
</li>
<li>Disable User Access Control (UAC) so that Sherlock can execute MSI installations. <strong>Note:</strong> In some cases corporate network controls and/or group policies override local settings. In those cases talk to the local IT people regarding UAC. Also note that on Windows 8 it is not possible to turn off the UAC by moving the &#39;UAC slider&#39; all the way down. This is because Metro applications require some form of UAC to exist in order for them to work.</li>
</ul>
<p>Finally before installing Sherlock a few tweaks should be made to the operating system configuration so that the automated tests can proceed. Note that for all the following changes there may be group policies in place put there by your local IT service. It may be necessary to talk to the IT people about the settings you want to change and the <a href="http://www.brianbondy.com/blog/id/100/">reason</a> you need to change those settings.</p>
<ul>
<li><strong>Interactive user:</strong> If you need to run interactive tests, e.g. UI tests, then you need to make sure a user is logged in. Use <a href="http://technet.microsoft.com/en-us/sysinternals/bb963905.aspx">Autologon</a> to automatically log your user in when the computer starts while still maintaining password security.</li>
<li><strong>Windows 8 switch to desktop:</strong> If you are on Windows 8 you need to make sure that the desktop is <a href="http://www.7tutorials.com/how-boot-desktop-windows-8-skip-start-screen">available</a> for interactive applications to execute on.</li>
<li><strong>Screen saver:</strong> In order to prevent any interactive tests from failing due to a <a href="http://windows.microsoft.com/en-nz/windows-vista/turn-your-screen-saver-on-or-off">screensaver</a> or the <a href="http://answers.microsoft.com/en-us/windows/forum/windows_7-security/disable-automatic-lock-with-windows-7/daef8f0a-810f-46e8-9420-3c32c4bd6479">automatic locking of the desktop</a> both those features need to be turned off. </li>
<li><strong>Windows error reporting:</strong> Any tests that run on the desktop may hang eternally if the application under tests fails and displays the Windows Error Reporting (WER) dialog. In order to prevent this from happening <a href="http://4sysops.com/archives/how-to-disable-windows-error-reporting/">WER should be disabled</a>. The most efficient way of doing this is to use the group policy controls to disable the following elements:<ul>
<li>In <code>Computer Configuration\Administrative Templates\System\Internet Communication Management\Internet Communication settings</code> enable the setting: <code>Turn off Windows Error Reporting</code>.</li>
<li>In <code>Computer Configuration\Administrative Templates\Windows Components\Windows Error Reporting</code> enable the settings <code>Disable Windows error reporting</code> and <code>Prevent display of the user interface for critical errors</code>, and disable the setting <code>Display error notification</code>.</li>
</ul>
</li>
<li><strong>Automatic updates:</strong> Automatic updates can be disabled because they will never be deployed due to the fact that the machine is reset after each test.</li>
</ul>
<h3 id="configuring-sherlock">Configuring Sherlock</h3>
<p>Once the operating system is configured <a href="/projects/sherlock.html">Sherlock</a> can be installed and configured. </p>
<ul>
<li>Unzip the <strong>service.zip</strong> package into the <code>c:\sherlock</code> directory.</li>
<li>Copy the XML file containing the public key used to sign the manifests to the virtual machine and place it in the <code>c:\sherlock</code> directory.</li>
<li>Open the configuration file (<code>Sherlock.Service.exe.config</code>) and update the following settings:<ul>
<li><strong>ApplicationName:</strong> The name of the application for which updates should be tracked, in this case that is: <code>Sherlock.Service.Executor.exe</code>.</li>
<li><strong>UpdateManifestUri:</strong> The URL of the manifest file, in this case: <code>http:\\myhostmachine\appupdate\executorservice.manifest</code></li>
<li><strong>ManifestPublicKeyFile:</strong> The path to the XML file containing the public key section of the manifest signing key, e.g. <code>C:\sherlock\manifestsigningkey.public.xml</code></li>
</ul>
</li>
<li>Set the update service to start automatically when the computer starts. This can be done as an actual service (in case no interactive tests will be executed) or by automatically starting the application when the user logs on to windows (in case interactive tests need to be executed).</li>
<li>The last step is to let the executor controller through the firewall. For this create an inbound rule that allows <code>c:\ProgramData\Sherlock\Sherlock.Service.Executor\{VERSION}\Sherlock.Service.Executor.exe</code> to connect to all types of protocols. Normally only Domain and private networks should be sufficient.</li>
</ul>
<h3 id="testing">Testing</h3>
<p>Once the operating system and Sherlock have been configured it is sensible to test the configurations to make sure it all works. In order to do this take the following steps:</p>
<ul>
<li>Restart the virtual machine. Once the machine starts up it should (depending on your configuration)<ul>
<li>Automatically log on the test user</li>
<li>On windows 8 switch to the desktop</li>
<li>Start the Sherlock update service. The service should download the latest version of the executor controller and start it. You can verify this by looking at the logs which can be found in <code>c:\programdata\sherlock\sherlock.service\{VERSION}\logs</code> and <code>c:\programdata\sherlock\sherlock.service.executor\{VERSION}\logs</code> for the update service and the executor controller respectively.</li>
</ul>
</li>
<li>After both applications have started stop them both by stopping the update service (<code>Sherlock.Service</code>).</li>
<li>Once the applications have been stopped remove the data from the directory <code>c:\ProgramData\Sherlock</code>.</li>
<li>Shut down the machine.</li>
<li>Take a <a href="http://blogs.msdn.com/b/virtual_pc_guy/archive/2008/01/16/managing-snapshots-with-hyper-v.aspx">snapshot</a> of the current state of the virtual machine and give it a sensible name.</li>
</ul>
<h3 id="host-configuration">Host configuration</h3>
<p>Finally the last step in the configuration of a new test environment is to register the environment with Sherlock through the management website.</p>
 
    </div>
</div>
    </div>


<!-- Page Listing -->

    <div class="pagination">
        <!-- Previous Page Button -->
        
            <a class="navlinks-prev" href="/index.4.html">Older</a>
        

        <!-- Next Page Button -->
        
            <a class="navlinks-next" href="/index.2.html">Newer</a>
        
    </div>

        </div>
    </div>
    <div id="footer" class="container">
        <div id="fbox1">
            <h2>Related</h2>

<ul>
    <li id="first"><a href="https://github.com/pvandervelde">GitHub</a></li>
    <li><a href="http://www.linkedin.com/profile/view?id=33950311">LinkedIn</a></li>
    <li><a href="http://stackoverflow.com/users/539846/petrik">StackOverflow</a></li>
    <li><a href="http://careers.stackoverflow.com/pvandervelde">StackOverflow Careers</a></li>
    <li><a href="https://plus.google.com/+PatrickvanderVelde/about">Google+</a></li>
</ul>
        </div>
        <div id="fbox2">
            <h2 id="copyright">Copyright</h2>
<p>Copyright (c) 2013 <a href="http://www.petrikvandervelde.nl">http://www.petrikvandervelde.nl</a>. All rights reserved.</p>
<h2 id="disclaimer">Disclaimer</h2>
<p>The opinions expressed herein are my own personal opinions and do not represent my employer&#39;s view in any way.</p>

        </div>
        <div id="fbox3">
            <h2 id="media">Media</h2>
<p><a href="/atom.xml"><img src="/images/feed.png" alt="Atom feed"></a></p>

        </div>
    </div>
    <div id="copyright" class="container">
        <p>
            Site design based on the <a href="http://www.freecsstemplates.org/previews/opentools/">Open Tools</a> design 
            by <a href="http://www.freecsstemplates.org">FreeCSSTemplates.org</a>.
        </p>
        <p>
            Feed icon by <a href="http://www.icojam.com/">Icojam</a> and Favicon by 
            <a href="http://www.flaticon.com/free-icon/twister-sky-wind_12318" title="Yannick">Yannick</a> 
            from <a href="http://www.flaticon.com" title="Flaticon">www.flaticon.com</a>
        </p>
        <p>Generated by <a href="http://docpad.org/" rel="nofollow">DocPad</a> on Thursday, October 02, 2014.</p>
    </div>

    <!-- jQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/vendor/jquery.js"><\/script>')</script>

    <!-- DocPad Scripts + Our Own -->
    <script >(function(){
	/* Did we just livereload? */
var log = !!(localStorage && console && console.log && true);
if ( log && localStorage.getItem('/docpad-livereload/reloaded') === 'yes' ) {
	localStorage.removeItem('/docpad-livereload/reloaded');
	console.log('LiveReload completed at', new Date())
}

/* Listen for the regenerated event and perform a reload of the page when the event occurs */
var listen = function(){
	var primus = new Primus('/docpad-livereload');
	primus.on('data', function(data){
		if ( data && data.message ) {
			if ( data.message === 'generateBefore' ) {
				if ( log ) {
					console.log('LiveReload started at', new Date());
				}
				if ( typeof document.getElementsByTagName !== 'undefined' ) {
	document.getElementsByTagName('html')[0].className += ' wait';
}
			}
			else if ( data.message === 'generateAfter' ) {
				if ( log ) {
					localStorage.setItem('/docpad-livereload/reloaded', 'yes');
				}
				document.location.reload();
			}
		}
	});
};
	/* Inject socket into our page */
var inject = function(){
	var t = document.createElement('script');
	t.type = 'text/javascript';
	t.async = 'async';
	t.src = '/primus/primus.js';
	t.onload = listen;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(t, s);
};
	if ( typeof Primus !== 'undefined' ) {
		listen();
	} else {
		inject();
	}
})();</script><script >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-46605109-1');
ga('send', 'pageview');</script><script defer="defer"  src="/vendor/log.js"></script><script defer="defer"  src="/vendor/modernizr.js"></script><script defer="defer"  src="/scripts/script.js"></script>
</body>
</html>