
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Mind vortex - Software development pipeline - Considerations for infrastructure improvements</title>
        <meta name="description" content="Welcome!" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link type="application/rss+xml" rel="alternate" title="Mind vortex" href="/feed.rss" />
        <link type="application/atom+xml" rel="alternate" title="Mind vortex" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/normalize.css" rel="stylesheet" />
        <link href="/assets/css/h5bp.css" rel="stylesheet">
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />
        <link href="/assets/css/github.css" rel="stylesheet" type="text/css">


        <meta name="application-name" content="Mind vortex" />
        <meta name="msapplication-tooltip" content="Mind vortex" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Mind vortex - Software development pipeline - Considerations for infrastructure improvements" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.petrikvandervelde.nl/posts/Software-development-pipeline-considerations-for-infrastructure-improvements" />
        <!-- TODO: More social graph meta tags -->

        <script src="/assets/js/jquery.min.js"></script>
        <script src="/assets/js/bootstrap.min.js"></script>
        <script src="/assets/js/highlight.pack.js"></script>
        <script src="/assets/js/clean-blog.js"></script>
        <script src="/assets/js/d3.v3.min.js"></script>
        <script src="/assets/js/trianglify.min.js"></script>
        <script src="/assets/js/Please-compressed.js"></script>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
                <script src="/assets/js/html5shiv.js"></script>
                <script src="/assets/js/respond.min.js"></script>
        <![endif]-->

        <!-- Our scripts -->
<script src="/assets/js/script.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DV643VJGFT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DV643VJGFT');
</script>


    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->
        <div id="header" class="container">
            <div id="logo">
                <h1><a href="/">Mind vortex</a></h1>
            </div>
            <div id="menu">
                <ul>
                            <!-- Pages -->
        <!-- BlogPosts -->
        <!-- Tags -->
        <!-- TagIndex -->
        <!-- BlogArchive -->
        <!-- Index -->
        <!-- RenderTagIndex -->
        <!-- RenderTags -->
        <!-- RenderBlogArchive -->
        <!-- Feed -->
        <!-- RenderBlogPosts -->
    <!-- Context.Documents['Pages'] -->
        <!-- 404 Not Found - False - /404 -->
        <!-- About - True - /about -->
        <!-- Apollo - False - /projects/apollo -->
        <!-- Calvinverse - False - /projects/calvinverse -->
        <!-- nAdoni - False - /projects/nadoni -->
        <!-- nAnicitus - False - /projects/nanicitus -->
        <!-- nBuildKit - False - /projects/nbuildkit -->
        <!-- nRefs - False - /projects/nrefs -->
        <!-- nTreva - False - /projects/ntreva -->
        <!-- Nuclei - False - /projects/nuclei -->
        <!-- Ops-Resource - False - /projects/ops-resource -->
        <!-- Projects - True - /projects -->
        <!-- Sherlock - False - /projects/sherlock -->
            <li class="inactive" >
                <a href="/">Home</a>
            </li>
            <li class="inactive" >
                <a href="/projects">Projects</a>
            </li>
            <li class="inactive" >
                <a href="/posts">Archive</a>
            </li>
            <li class="inactive" >
                <a href="/tags">Tags</a>
            </li>
            <li class="inactive" >
                <a href="/about">About</a>
            </li>

                </ul>
            </div>
        </div>

        <div id="page" class="container">
            <div id="sidebar">
                <div id="sbox1">
                    <h2>Patrick van der Velde</h2>

<p>
    <img src="https://www.gravatar.com/avatar/9bc8b3ff385cd14f2b12138c97729df2?s=160" alt="Gravatar for Patrick van der Velde">
</p>
<p>
    Dutch software developer, living, working and playing in New Zealand.
    Rock climber, and paragliding pilot. Developer of
    <a href="https://nbuildkit.github.io/nBuildKit.MsBuild/">nBuildKit</a>,
    <a href="https://github.com/Calvinverse">the Calvinverse resources</a> and other projects
</p>
<p>
    <a href="/about.html">More ...</a>
</p>

                </div>
                <div id="sbox2">
                    <h2>Recent</h2>
                    <ul class="list-unstyled">
                            <li><a href="/posts/Software-development-pipeline-infrastructure-dependency-reduction">Software development pipeline - Infrastructure dependency reduction</a></li>
                            <li><a href="/posts/Calvinverse-an-example-build-infrastructure">Calvinverse - An example build infrastructure</a></li>
                            <li><a href="/posts/On-prem-vs-cloud-build-systems">Software development pipeline - On-prem or in the cloud?</a></li>
                            <li><a href="/posts/Software-development-pipeline-considerations-for-infrastructure-improvements">Software development pipeline - Considerations for infrastructure improvements</a></li>
                            <li><a href="/posts/Sofware-development-pipeline-In-the-build-system-or-not">Software development pipeline - In the build system or not</a></li>
                            <li><a href="/posts/Software-development-pipeline-Design-flexibility">Software development pipeline - Design flexibility</a></li>
                            <li><a href="/posts/Software-development-pipeline-Design-resilience">Software development pipeline - Design resilience</a></li>
                            <li><a href="/posts/Software-development-pipeline-Design-performance">Software development pipeline - Design performance</a></li>
                            <li><a href="/posts/Exportable-Linux-virtual-hard-drives-for-hyper-v">Exportable Linux virtual hard-drives for Hyper-V</a></li>
                            <li><a href="/posts/Software-development-pipeline-Design-accuracy">Software development pipeline - Design accuracy</a></li>
                    </ul>
                </div>
                <div id="sbox3">
                    <h2>Tags</h2>
                    <div>
                        <ul class="list-unstyled">
                                <li>
                                    <a role="button" href="/tags/Sherlock" class="btn btn-default btn-sm"> Sherlock (13)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/nBuildKit" class="btn btn-default btn-sm"> nBuildKit (12)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/Software-development-pipeline" class="btn btn-default btn-sm"> Software development pipeline (10)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/Delivering-software" class="btn btn-default btn-sm"> Delivering software (10)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/DevOps" class="btn btn-default btn-sm"> DevOps (10)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/Paragliding" class="btn btn-default btn-sm"> Paragliding (9)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/PG2" class="btn btn-default btn-sm"> PG2 (9)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/Blog" class="btn btn-default btn-sm"> Blog (7)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/Nuclei" class="btn btn-default btn-sm"> Nuclei (6)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/Pipeline-design" class="btn btn-default btn-sm"> Pipeline design (6)</a>
                                </li>
                        </ul>
                    </div>
                    <br />
                    <ul class="pager">
                        <li class="next">
                            <a href="/tags">View All Tags &rarr;</a>
                        </li>
                    </ul>
                </div>
            </div>

            <div id="content">

<div id="post">
    <div id="post-header">
        <!--
    Model is: Tuple<IDocument, IDocument>.
    The first one is the current document that is being rendered, the second one is the one for which the post header should be rendered.
-->


<h2>
Software development pipeline - Considerations for infrastructure improvements</h2>
<div id="post-meta">
    <div class="meta-date">
Sunday, January 27, 2019
 |             Posted in     </div>
    <div class="meta-tags">
                        <a id="post-category" role="button" href="/tags/Delivering-software" class="btn btn-default btn-xs tag-no-wrap">Delivering&nbsp;software</a>
                        <a id="post-category" role="button" href="/tags/DevOps" class="btn btn-default btn-xs tag-no-wrap">DevOps</a>
                        <a id="post-category" role="button" href="/tags/Immutable-infrastructure" class="btn btn-default btn-xs tag-no-wrap">Immutable&nbsp;infrastructure</a>
                        <a id="post-category" role="button" href="/tags/Infrastructure-as-code" class="btn btn-default btn-xs tag-no-wrap">Infrastructure&nbsp;as&nbsp;code</a>
                        <a id="post-category" role="button" href="/tags/Software-development-pipeline" class="btn btn-default btn-xs tag-no-wrap">Software&nbsp;development&nbsp;pipeline</a>
    </div>
</div>

    </div>

    <div id="post-content">
        <p>In one of the post from a <a href="/posts/Software-development-pipeline-Design-introduction.html">while ago</a> we
discussed what a software development pipeline is and what the <a href="/posts/Software-development-pipeline-Design-accuracy.html">most</a>
<a href="/posts/Software-development-pipeline-Design-performance.html">important</a>
<a href="/posts/Software-development-pipeline-Design-resilience.html">characteristics</a>
<a href="/posts/Software-development-pipeline-Design-flexibility.html">are</a>. Given that the pipeline is used
during the large majority of the development, test and release process it is fair to say that for
a software company the build and deployment pipeline infrastructure should be considered critical
infrastructure because without it the development team will be more limited in their ability to
perform their tasks. Note that at no stage should any specific tool, including the pipeline, be the
single point of failure. More on how to reduce the dependency on CI systems and the pipeline will
follow in another post.</p>
<p>Just like any other piece of infrastructure the development pipeline will need to be updated
and improved on a regular basis, either to fix bugs, patch security issues or to add new features
that will make the development team more productive. Because the pipeline falls in the critical
infrastructure category it is important to keep disturbances to a minimum while performing these
changes. There are two main parts to providing (nearly) continuous service while still providing
improvements and updates. The first is to ensure that the changes are tracked and tested properly,
the second is to deploy the exact changes that were tested to the production system in a way that no
or minimal interruptions occur. A sensible approach to the first part is to follow a solid software
development process so that the changes are controlled, verified and monitored which can be achieved
by creating infrastructure resources completely from information stored in source control, i.e. using
<a href="https://en.wikipedia.org/wiki/Infrastructure_as_code">infrastructure-as-code</a>, making the resources
as <a href="https://thenewstack.io/a-brief-look-at-immutable-infrastructure-and-why-it-is-such-a-quest/">immutable</a>
as <a href="https://twitter.com/jezhumble/status/970334897544900609">possible</a> and performing automated tests
on these resources after deploying them in a test environment using the same deployment process that
will be used to deploy the resources to the production environment.</p>
<p>Using this approach should allow the creation of resources that are thoroughly tested and can be
deployed in a sensible fashion. It should be noted that no amount of automated testing will
guarantee that the new resources are free of any issues so it will always be important use deployment
techniques that allow for example <a href="https://martinfowler.com/bliki/BlueGreenDeployment.html">quick roll-back</a>
or <a href="https://martinfowler.com/bliki/CanaryRelease.html">staged roll-outs</a>. Additionally deployed
resources should be carefully monitored so that issues will be discovered quickly.</p>
<p>To achieve the goal of being able to deploy updates and improvements to the development
infrastructure the following steps can be taken</p>
<ul>
<li>Using infrastructure-as-code to create new resource images each time a resource needs to be updated.
Trying to create resources by hand will drastically reduce the ease at which they can be build and
be made consistently. Resources that are deployed into an environment should never be changed. If
bugs need to be fixed or new features need to be added then a new version of the resource image
should be created, tested and deployed. That way changes can be tested before deployment and
the configuration of the deployed resources will be known.</li>
<li>Resources should be placed on virtual machines or in (Docker) containers. Both technologies provide
an easy way to create one or more instances of the resource which is required in order to test or
scale a service. The general idea is to have one resource per VM / container instance. One resource
may contain multiple services or daemons but it always serves a single goal. Note that in some cases
people will state that you should only use containers and not VMs but there are still cases where
a VM works better, e.g. in some cases executing software builds works better in a VM or running
a service that stores large quantities of data. Additionally if all or a large part of the
infrastructure is running on VMs then using VMs might make more sense. In all cases the correct
approach, container or VMs, is the one that makes sense for the environment the resources will
be deployed into.</li>
<li>Some way of getting configurations into the resource. Some configurations can be hard-coded into
the resource, if they are never expected to be changed. The draw-back of encoding a configuration
into a resource is that this configuration cannot be changed if the resource is used in different
environments, e.g. a test environment and a production environment. Configurations which are
different between environments should not be encoded in the resource since that may prevent the
resource from being deployed in a test environment for testing. Provisioning a resource requires
that you can apply all the environment specific information to a resource which is a difficult
problem to solve especially for the initial set of configurations, e.g. the configurations which
determine where to get the remaining configurations. Several options are:
<ul>
<li>For VMs you can use DVD / ISO files that are linked on first start-up of the resource.</li>
<li>Systems like <a href="https://github.com/hashicorp/consul-template">consul-template</a> can generate
configurations from a distributed key-value store.</li>
<li>Resources can be pull their own configurations from a shared store.</li>
<li>For containers often environment variables are used. These might be sufficient but note that they
are not secure, both inside the container and outside the container.</li>
</ul>
</li>
<li>Configurations that should be provided when a resource is provisioned should be stored
in source control, just like the resource code is, in order to be able to automate the verification
and delivery of the configuration values.
<ul>
<li>The infrastructure should have it's own shared storage for configurations so that the &lsquo;build&rsquo;
process can push to the shared storage and configurations are distributed from there. That ensures
that the build process doesn't need to know where to deliver exactly (which can change as the
infrastructure changes). One option is to use SQL / no-SQL type storage (e.g. Elasticsearch),
another option is to use a system like <a href="https://consul.io">consul</a> which has a distributed key-value
store</li>
</ul>
</li>
<li>Automatic testing of a resource once it is deployed into an environment. For the very least the
smoke tests should be run automatically when the resource is deployed to a test environment.</li>
<li>Automatic deployments when a new resource becomes available or approved for an environment, for
the very least to the test environment but ideally to all environments. Using the same deployment
system for all environments is highly recommended because this allows testing the deployment
process as well as the resource.</li>
</ul>
<p>A general workflow for the creation of a new resource or to update a resource could be</p>
<ul>
<li>Update the code for the resource. This code can consist of Docker files, <a href="https://www.chef.io/">Chef</a>
or <a href="https://puppet.com/">Puppet</a>, scripts etc.. The most important thing is that the files are
stored in source control and a sensible source control strategy is used.</li>
<li>Once the changes are made a new resource can be created from the code.
<ul>
<li>It is sensible to validate the sources using one or more suitable linters. Especially for infrastructure
resources it is sensible to validate the sources before trying to create the resource because it
potentially takes a long time to build a resource. Any errors that can be found sooner in the
process will reduce the cycle time.</li>
<li>Execute unit tests, e.g. <a href="https://docs.chef.io/chefspec.html">ChefSpec</a>, against the sources.
Again, building a resource can take a long time so validation before trying to create the resource
will reduce the cycle time.</li>
<li>Actually create the new resource. For Docker containers this can be done from a
<a href="https://docs.docker.com/engine/reference/builder/">docker file</a>. For a VM this can be done with
<a href="https://packer.io">Packer</a>. Building a VM will take longer than building a docker container in
most cases. Note that building resources will in general take longer than building applications
it is sensible to use the build / deployment pipeline to build the resources that make up the
build / deployment pipeline. By using the pipeline it is possible to create the artefacts for
the services and then use these artefacts to create the resource.</li>
</ul>
</li>
<li>Deploy the resource to a (small) test environment and execute the tests against the newly created
resource.</li>
<li>Once the tests have passed the newly made image can be &lsquo;promoted&rsquo;, i.e. approved for use in the
production environment.</li>
</ul>
<p>Using the approaches mentioned above it is possible to improve the development pipeline without
causing unnecessary disturbances for the development team.</p>
<p>Edit: Changed the title from <code>software delivery pipeline</code> to <code>software development pipeline</code> to match
the other posts.</p>

    </div>

    <div id="post-footer">
        <div>
    <div class="navlinks">
                <a href="/posts/Sofware-development-pipeline-In-the-build-system-or-not" title="Previous Post: Software development pipeline - In the build system or not" class="navlinks-prev">« Software development pipeline - In the build system or not</a>
                <a href="/posts/On-prem-vs-cloud-build-systems" title="Next Post: Software development pipeline - On-prem or in the cloud?" class="navlinks-next">Software development pipeline - On-prem or in the cloud? »</a>
    </div>
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'mindvortex'; // required: replace example with your forum shortname
    var disqus_identifier = 'Software-development-pipeline-considerations-for-infrastructure-improvements';
    var disqus_title = 'Software development pipeline - Considerations for infrastructure improvements';
    var disqus_url = 'https://www.petrikvandervelde.nl/posts/Software-development-pipeline-considerations-for-infrastructure-improvements';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </div>
</div>







            </div>
        </div>

        <footer>
            <div id="footer" class="container">
    <div id="fbox1">
        <h2>Related</h2>
        <ul>
            <li><a href="https://github.com/pvandervelde"><i class="fa fa-github"></i> GitHub</a></li>
            <li><a href="https://www.linkedin.com/profile/view?id=33950311"><i class="fa fa-linkedin"></i> LinkedIn</a></li>
            <li><a href="https://stackoverflow.com/users/539846/petrik"><i class="fa fa-stack-overflow"></i> StackOverflow</a></li>
            <li><a href="https://careers.stackoverflow.com/pvandervelde"><i class="fa fa-stack-overflow"></i> StackOverflow Careers</a></li>
            <li><a href="https://twitter.com/petrikvdvelde"><i class="fa fa-twitter"></i> Twitter</a></li>
            <li><a href="https://profile.codersrank.io/user/pvandervelde">CodersRank</a></li>
        </ul>
    </div>
    <div id="fbox2">
        <h2 id="copyright">Copyright</h2>
        <p>Copyright (c) 2020 <a href="/">Petrik van der Velde</a>. All rights reserved.</p>

        <h2 id="disclaimer">Disclaimer</h2>
        <p>The opinions expressed herein are my own personal opinions and do not represent my employer's view in any way.</p>
    </div>
    <div id="fbox3">
        <h2 id="media">Media</h2>
        <p><a href="/feed.atom"><img src="/assets/images/feed.png" alt="Atom feed"></a></p>
    </div>
</div>
<div id="copyright" class="container">
    <div>
        <p>
            Generated by <a href="https://wyam.io">Wyam</a> on Mon, 02 Nov 2020 03:56:39 GMT

 from commit <a href="https://github.com/pvandervelde/mindvortex/tree/288bf9c632030fc4c577d7a84a187f8d06566df1">288bf9c632030fc4c577d7a84a187f8d06566df1</a> at version 3.2.0.        </p>
    </div>

    <p>
        Site design based on the <a href="https://www.freecsstemplates.org/previews/opentools/">Open Tools</a> design
        by <a href="https://www.freecsstemplates.org">FreeCSSTemplates.org</a>.
    </p>
    <p>
        Feed icon by <a href="https://www.icojam.com/">Icojam</a> and Favicon by
        <a href="https://www.flaticon.com/free-icon/twister-sky-wind_12318" title="Yannick">Yannick</a>
        from <a href="https://www.flaticon.com" title="Flaticon">www.flaticon.com</a>
    </p>
</div>

        </footer>
    </body>
</html>
