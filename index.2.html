<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head> 
    <!-- Standard Meta -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width" />

    <!-- Site Properities -->
    <title>Home | Mind Vortex</title>
    <meta name="description" content="The place where I ramble on about software development, fluid dynamics, flying and climbing." />
    <meta name="keywords" content="Patrick van der Velde, Petrik, Nuclei, Sherlock, nAnicitus, nAdoni, nTreva, rock climbing, paragliding" />
    <meta name="author" content="Petrik van der Velde" />

    <!-- DocPad Meta -->
    <meta name="generator" content="DocPad v6.65.0" />

    <!-- DocPad Styles + Our Own -->
    <style >html.wait {
	cursor: wait !important;
	opacity: 0;
	transition: opacity 0.5s ease;
}</style><link  rel="stylesheet" href="/vendor/normalize.css" /><link  rel="stylesheet" href="/vendor/h5bp.css" /><link  rel="stylesheet" href="/styles/style.css" /><link  rel="stylesheet" href="/styles/github.css" />

    <!-- Icons -->
    <!-- Favicon -->
    <link rel="shortcut icon" href="/icons/twister.ico" />
    
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
</head>
<body>
    <!--[if lt IE 7]>
        <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
    <![endif]-->
    
    <div id="header" class="container">
        <div id="logo">
            <h1><a href="/">Mind Vortex</a></h1>
        </div>
        <div id="menu">
            <ul>
                
                    <li class="inactive">
                        
                            <a href="/index.html">Home</a>
                        
                    </li>
                
                    <li class="inactive">
                        
                            <a href="/projects.html">Projects</a>
                        
                    </li>
                
                    <li class="inactive">
                        
                            <a href="/archives.html">Archives</a>
                        
                    </li>
                
                    <li class="inactive">
                        
                            <a href="/about.html">About</a>
                        
                    </li>
                
            </ul>
        </div>
    </div>
    <div id="page" class="container">
        <div id="sidebar">
            <div id="sbox1">
                <h2 id="patrick-van-der-velde">Patrick van der Velde</h2>
<p><img src="http://www.gravatar.com/avatar/9bc8b3ff385cd14f2b12138c97729df2?s=160" alt="Gravatar for Patrick van der Velde"> </p>
<p>Dutch software developer, living, working and playing in New Zealand. 
Rock climber, and future paragliding pilot. Developer of <a href="http://pvandervelde.github.io/Sherlock">Sherlock</a>, 
<a href="http://pvandervelde.github.io/Nuclei">Nuclei</a> and other projects</p>
<p><a href="/about.html">More ...</a></p>

            </div>
            <div id="sbox2">
                <h2>Recent</h2>
                <ul>
                    
                        <li><a href="/posts/2014-09-27_Building-and-delivering-nBuildKit-with-AppVeyor.html">Building and delivering nBuildKit with AppVeyor</a></li>
                    
                        <li><a href="/posts/2014-08-19_nBuildKit-release-V032.html">nBuildKit release - V0.3.2</a></li>
                    
                        <li><a href="/posts/2014-07-26_Adding-pagination-with-DocPad.html">Adding pagination with DocPad</a></li>
                    
                        <li><a href="/posts/2014-07-24_Blog-archives-by-DocPad.html">Blog archives by DocPad</a></li>
                    
                        <li><a href="/posts/2014-07-21_nBuildKit-release-V024.html">nBuildKit release - V0.2.4</a></li>
                    
                        <li><a href="/posts/2014-06-16_nBuildKit-release-V015.html">nBuildKit release - V0.1.5</a></li>
                    
                        <li><a href="/projects/nbuildkit.html">nBuildKit</a></li>
                    
                        <li><a href="/posts/2014-05-28_Nuclei-release-V080.html">Nuclei release - V0.8.0</a></li>
                    
                        <li><a href="/posts/2014-05-23_Improvements-to-the-site.html">Improvements to the site</a></li>
                    
                        <li><a href="/projects/nrefs.html">nRefs</a></li>
                    
                </ul>
            </div>
            <div id="sbox3">
                <h2>Tags</h2>
                
                    <a href="/tags/apollo.html" style="font-size: 113.13247675185968%">
                        Apollo
                    </a>
                
                    <a href="/tags/appveyor.html" style="font-size: 100%">
                        AppVeyor
                    </a>
                
                    <a href="/tags/blog.html" style="font-size: 130.49266672559813%">
                        Blog
                    </a>
                
                    <a href="/tags/climbing.html" style="font-size: 100%">
                        Climbing
                    </a>
                
                    <a href="/tags/configuration.html" style="font-size: 100%">
                        Configuration
                    </a>
                
                    <a href="/tags/console.html" style="font-size: 100%">
                        Console
                    </a>
                
                    <a href="/tags/continous-integration.html" style="font-size: 113.13247675185968%">
                        Continous integration
                    </a>
                
                    <a href="/tags/docpad.html" style="font-size: 120.81448319328996%">
                        DocPad
                    </a>
                
                    <a href="/tags/github.html" style="font-size: 100%">
                        GitHub
                    </a>
                
                    <a href="/tags/gitversion.html" style="font-size: 100%">
                        GitVersion
                    </a>
                
                    <a href="/tags/jenkins.html" style="font-size: 120.81448319328996%">
                        Jenkins
                    </a>
                
                    <a href="/tags/job-template.html" style="font-size: 100%">
                        Job template
                    </a>
                
                    <a href="/tags/msbuild.html" style="font-size: 100%">
                        MsBuild
                    </a>
                
                    <a href="/tags/nuclei.html" style="font-size: 150%">
                        Nuclei
                    </a>
                
                    <a href="/tags/pdb.html" style="font-size: 113.13247675185968%">
                        PDB
                    </a>
                
                    <a href="/tags/pg2.html" style="font-size: 141.62896638657992%">
                        PG2
                    </a>
                
                    <a href="/tags/paragliding.html" style="font-size: 136.86752324814032%">
                        Paragliding
                    </a>
                
                    <a href="/tags/regression-test.html" style="font-size: 100%">
                        Regression test
                    </a>
                
                    <a href="/tags/regression-testing.html" style="font-size: 113.13247675185968%">
                        Regression testing
                    </a>
                
                    <a href="/tags/srcsrv.html" style="font-size: 100%">
                        SRCSRV
                    </a>
                
                    <a href="/tags/scripting.html" style="font-size: 100%">
                        Scripting
                    </a>
                
                    <a href="/tags/sherlock.html" style="font-size: 148.59593857014607%">
                        Sherlock
                    </a>
                
                    <a href="/tags/software-delivery.html" style="font-size: 100%">
                        Software delivery
                    </a>
                
                    <a href="/tags/source-server.html" style="font-size: 100%">
                        Source server
                    </a>
                
                    <a href="/tags/symstore.html" style="font-size: 100%">
                        SymStore
                    </a>
                
                    <a href="/tags/symbol-server.html" style="font-size: 100%">
                        Symbol server
                    </a>
                
                    <a href="/tags/symbol-stream.html" style="font-size: 100%">
                        Symbol stream
                    </a>
                
                    <a href="/tags/teamcity.html" style="font-size: 100%">
                        TeamCity
                    </a>
                
                    <a href="/tags/teststack-white.html" style="font-size: 100%">
                        TestStack.White
                    </a>
                
                    <a href="/tags/ui-test.html" style="font-size: 100%">
                        UI test
                    </a>
                
                    <a href="/tags/unc.html" style="font-size: 100%">
                        UNC
                    </a>
                
                    <a href="/tags/wcf.html" style="font-size: 126.26495350371935%">
                        WCF
                    </a>
                
                    <a href="/tags/waipapa.html" style="font-size: 100%">
                        Waipapa
                    </a>
                
                    <a href="/tags/writing.html" style="font-size: 100%">
                        Writing
                    </a>
                
                    <a href="/tags/nadoni.html" style="font-size: 113.13247675185968%">
                        nAdoni
                    </a>
                
                    <a href="/tags/nanicitus.html" style="font-size: 130.49266672559813%">
                        nAnicitus
                    </a>
                
                    <a href="/tags/nbuildkit.html" style="font-size: 126.26495350371935%">
                        nBuildKit
                    </a>
                
                    <a href="/tags/nrefs.html" style="font-size: 100%">
                        nRefs
                    </a>
                
            </div>
        </div>
        <div id="content">
            
    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2014-03-31_Regression-testing-gui-applications.html'>GUI testing with TestStack.White</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Monday, March 31, 2014 | Posted in
                
                    <a id="post-category" href="/tags/regression-testing.html">Regression testing</a>
                
                    <a id="post-category" href="/tags/ui-test.html">UI test</a>
                
                    <a id="post-category" href="/tags/teststack.white.html">TestStack.White</a>
                
                    <a id="post-category" href="/tags/apollo.html">Apollo</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>In the <a href="/posts/2014-02-18_Regression-testing-console-applications.html">previous</a> post I explained how I created the regression tests for a script running application that belongs to the <a href="/projects/apollo.html">Apollo</a> project. In this post I will explain how I created the regression tests for an Apollo application with a graphical user interface (UI).</p>
<p>My initial attempt to write a regression test suite for the GUI application was done using the <a href="http://www.nunit.org/">NUnit</a> and <a href="http://scriptcs.net/">ScriptCS</a> with the idea that NUnit would provide the test execution and validation methods and ScriptCs would provide an easy way to write the test scripts without requiring a complete IDE to be used. After some trial-and-error it became clear that this approach was not the most suitable solution for the following reasons:</p>
<ul>
<li>Using NUnit, or any unit test framework for that matter, complicated things because there is no way to take control of the order in which the regression tests are executed. While the ordering of unit tests is irrelevant, the ordering of regression tests may not be in that it is accepted that regression tests involve the execution multiple, ordered tests for one single activation of the application under test (AUT).</li>
<li>A secondary drawback of using a unit test framework is that there is normally no way to re-run a test case if it fails, something which is more acceptable for a regression test than for a unit test.</li>
<li>The test code got rather complicated due to the many helper methods, script files etc.. While ScriptCs coped beautifully with this it turned out to hard for me to work with without the organizing features of a complete IDE.</li>
</ul>
<p>In the end I wrote a custom (console) application that handles the ordering and execution of the different test cases in the way that makes sense for my current requirements.</p>
<h4 id="testing-application">Testing application</h4>
<p>The testing application executes the tests, collects the results and logs all the outputs. When executing the tests each test is executed a maximum of three times before it is marked as a fail. The following code is used by the application to execute the test steps and to keep track of the number of times a test step is executed. </p>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_ExecuteTestStep.cs'></script>

<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_TestStep.cs'></script>

<p>The reason for having multiple attempts to complete a test is that the nature of the GUI automation testing is that it is not completely <a href="http://www.mathpirate.net/log/2009/12/23/ui-automation-tricks-and-traps/">consistent</a>. By allowing a test to fail twice it is possible to work around the problem of inconsistent handling of controls.</p>
<p>The second part of the application keeps track of the test results while the tests are running. The application will always try to execute all the tests, irrespective of their final success or failure. That way the user will always have a complete report of the state of all the tests.</p>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_EntryPoint.cs'></script>

<p>Finally the application provides utility methods for logging which should be used liberally by both the application and the test steps.</p>
<h4 id="tests">Tests</h4>
<p>In order for the tests to interact with the GUI I chose to use the <a href="https://github.com/TestStack/White">TestStack.White</a> library mainly because it is a mature open source library that has a number of active contributors. One thing to keep in mind when selecting a GUI automation library is that the <a href="http://en.wikipedia.org/wiki/Microsoft_UI_Automation">underlying technology</a> has some tricky hooks to it that cannot be completely hidden by the automation library. One example is that all controls can be found based on their <a href="http://msdn.microsoft.com/en-us/library/aa349646%28v=vs.110%29.aspx">automation ID</a> but windows cannot, even if the window in question has an automation ID.</p>
<p>The main piece of advice for writing UI automation tests is always to write some helper methods to hide the underlying complexity of the UI access technology. In my case I took the following steps:  </p>
<ul>
<li>Control very carefully how your helper methods return information to the caller, either through a return value or through exceptions. In my case if a helper method returns a value it should either return the requested object or null if it fails to get the requested object. The calling code should then always check for null and handle the case of a null return value, e.g. by retrying the method call. The only time the method will throw an exception is if the assumed conditions for the method are wrong, e.g. the application under test (AUT) has crashed. If the helper method has no return value then it may throw if it fails to execute.</li>
</ul>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_HelpersForMenu.cs'></script>

<ul>
<li>All actions that get a control will try to get the control several times if they fail. Due to the nature of UI automation it is possible that the control is not available the first time the code tries to get hold of the control. This may be due tot he fact that the automation tests are fast enough that they try to get the control in the 0.1 second that the control is not available yet. Note that this also makes for some very tricky debugging which requires a decent amount of logging. </li>
</ul>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_Retry.cs'></script>

<p>Note that automation tests are usually linked strongly to a specific version of the software because the tests assume the availability of certain automation IDs and controls. Some parts are implicitly linked and others can be, but don&#39;t have to be, explicitly linked. Examples are: </p>
<ul>
<li>The application, product and company names can be shared through a configuration or shared code file:</li>
</ul>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_CompanyInformation.cs'></script>

<ul>
<li>Automation IDs can be shared via a shared code file. Note that application ID names should be pointing to a given area / functionality, not specific controls (Also note that in my case that&#39;s not always done the right way):</li>
</ul>
<script src='https://gist.github.com/9202656.js?file=Apollo_Regression_AutomationID.cs'></script>

<script src='https://gist.github.com/9202656.js?file=Apollo_Explorer_MenuView.xaml'></script>

<p>When executing the tests it is a good idea to reset your application state either at the end of each test or at the start of each test. Or even better both to make sure that you always start a test from the same state irrespective of the way the previous test ended, e.g. with an application crash.</p>
<p>Finally do not give up if you find it hard to make the tests reliable. By continually improving the robustness of the test code eventually the tests will start to behave in the way you expect them too. Some <a href="http://www.mathpirate.net/log/2009/12/23/ui-automation-tricks-and-traps/">tricks and hacks</a> that I found necessary are:</p>
<ul>
<li>Time-outs while getting controls, setting values on controls or getting values from controls. While these are ugly they are sometimes necessary.</li>
<li>For each test restart the application if at all possible so that you end up with a known application state. This will improve the repeatability of the tests. Note that if the application is slow to start up then you can either improve the start up performance of the application or if that is not possible then carefully combine tests but be aware that tests may fail due to polluted application state. </li>
<li>Note that some application state survives restarts, e.g. user and application settings. It would be good if you have a way of resetting that state in a relatively sure-fire way. This is something I have not implemented yet though.</li>
</ul>
<p>And then the last comment must be that the development of these tests has been much more complicated than I thought it would be. The approach I used required some coding skills so this may or may not be suitable in other situations depending on the skill sets of the testers or developers.</p>
 
    </div>
</div>
    </div>

    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2014-02-18_Regression-testing-console-applications.html'>Regression testing of a console application</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Tuesday, February 18, 2014 | Posted in
                
                    <a id="post-category" href="/tags/regression-testing.html">Regression testing</a>
                
                    <a id="post-category" href="/tags/console.html">Console</a>
                
                    <a id="post-category" href="/tags/apollo.html">Apollo</a>
                
                    <a id="post-category" href="/tags/scripting.html">Scripting</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>After <a href="/posts/2013-12-04_Regression-testing-with-Sherlock.html">setting up</a> <a href="/projects/sherlock.html">Sherlock</a> you will need to create some tests that you can execute with Sherlock. In this post I will describe how I created the regression tests for the command line application of <a href="/projects/apollo.html">Apollo</a>.</p>
<p>For this case the application-under-test (AUT) is the Apollo console application which provides the user with a way to control the capabilities of Apollo, e.g. running a fluid dynamics simulation, by executing a Python script. The goal of the regression test for the console application is to execute a large part of the API which is used by scripts to interact with the different parts of Apollo.</p>
<p>In order to test the scripting API I wrote several scripts that will be executed during the test. Each script exercises several parts of the API and checks after each action that the state of the application is as expected. An example of a test script is given in the following code segment:</p>
<script src='https://gist.github.com/8995251.js'></script>

<p>This test script:</p>
<ol>
<li>Verifies that no project exists at start-up. If one exists the test is considered failed and the script forces the application to exit with a non-zero exit code.</li>
<li>Creates a new project and obtains a reference to the new project. If either step fails then once again the application is forced to exit with a non-zero exit code.</li>
<li>The name of the project is changed and the script verifies that the new name has been stored.</li>
</ol>
<p>Obviously the script given here is a rather trivial and somewhat naive test script however it does provide an idea of what a test script should do.</p>
<p>In order to inform Sherlock that the script execution has failed the script can either write to the error stream or it can force the application to exit with a non-zero error code. To provide data for fault analysis a test script can write to both the standard output stream and the error data stream. Information gathered from either stream will be placed in the Sherlock log, which can be copied back to the report location by setting the correct switches. Additionally any data on the error stream will be written to the test report.</p>
<p>It is important to note that the test script should be robust enough to handle any kind of problem encountered because there is no guarantee that the application will behave in the appropriate manner, after all the application is being tested to see if it is fit for purpose.</p>
<p>Once the test scripts are written you can create a test configuration for the different test steps. An example is given below:</p>
<script src='https://gist.github.com/8995455.js'></script>

<p>The important things to note in this configuration are:</p>
<ul>
<li>Each test step copies back the system log files which include:<ul>
<li>The Sherlock log file written on the test environment.</li>
<li>Any MSI install log files.</li>
</ul>
</li>
<li>The test script executing test step also copies the log files written by the console application.</li>
</ul>
 
    </div>
</div>
    </div>

    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2014-01-31_PG2-Site-number-five.html'>PG2 - Site number five</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Friday, January 31, 2014 | Posted in
                
                    <a id="post-category" href="/tags/pg2.html">PG2</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>Two weeks ago I managed to fulfil another criteria for my PG2 license by flying at the  <a href="http://paraglidingnewzealand.com/places-to-fly/site/mangawhai-heads">Mangawhai Heads</a> for my fifth site. </p>
<p>Unlike the other locations the launch site at Mangawhai heads is rather small, just big enough for the glider. Because of the conditions and the amount of space at the launch location I elected to do a forward launch with some assistance of the instructor. That turned out to be a good decision because as soon as the glider was above my head it caught the wind stream and I rocketed off the ground. Unfortunately with all the pre-launch action going on I had neglected to completely check my glider which meant I ended up with a small line tangle in the top C-D line which slowed my glider down a bit during flight. </p>
<p>After about 20 minutes of flying I started to notice that my ground speed was reducing more and more, at which point I decided it was better to be on the ground wishing I was in the sky than being in the sky wishing I was on the ground and so I landed on the beach.</p>
<p>The learning points of this flight are:</p>
<ul>
<li>Reducing the seat depth of my harness has made flying a lot more comfortable, at least for shorter flights. I guess I will see how comfortable it is during longer flights. </li>
<li>The addition of a stir-up makes getting into the harness much easier. All I have to do now is stand up on the stir-up and I&#39;m in the seat. I&#39;m still not used to staying on the stir-up during flight though so I will have to work out what to do with that, especially during turns.</li>
<li>I really should start practising my asymmetrical launches so that I can use those during high wind launch situations to reduce the pressures on the glider and myself during the initial part of the launch.</li>
</ul>
 
    </div>
</div>
    </div>

    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2014-01-21_PG2-Christmas-holiday-antics.html'>PG2 - Christmas holiday antics</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Tuesday, January 21, 2014 | Posted in
                
                    <a id="post-category" href="/tags/pg2.html">PG2</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>During the Christmas holidays a few weeks ago I was planning to get lots of flying done, after all I had two weeks off and the weather had been amazing while I was in the office so what else could be the case? Unfortunately it turned out that the weather gods had other plans and provided generous helpings of wind and rain. That meant I only managed to fly on two different days. </p>
<p>However that doesn&#39;t mean that the Christmas holidays were lacking paragliding activities. You see my new <a href="http://www.korteldesign.com/spip/?Karma-II-231">harness</a> arrived just before Christmas. It was ordered three or so months ago but it was completely worth the wait. The build quality is very high and the harness felt comfortable straight away. Mind you there is still some set up to be done. There are a lot of different straps on this harness which subtly change the position and shape of the harness. I suspect it will be a while before I find all the right settings.
The biggest difference so far compared to the school harnesses is that it feels like the harness reacts more to changes in the glider, which at the moment is unsettling but I guess I&#39;ll get used to it. And the second difference is that the harness is harder to get into.   </p>
<p>Given that I was already spending money I figured I should spend some more ... Actually it was more like there were a few other things that were either <a href="http://en.wikipedia.org/wiki/Altimeter">legally required</a> or <a href="http://en.wikipedia.org/wiki/Parachute">very sensible</a> to have. And so I also bought a <a href="http://www.brauniger.com/en/products/flight-instruments/iq-basic-gps/overview.html">vario</a> and a <a href="http://gingliders.com/rescue-systems/yeti-light-rescue/">reserve</a>. The combination was not cheap but I do feel a lot safer now that I have a way to tell how high I am and a way to come down in case everything goes to custard.</p>
<p>Finally I also did my PG2 theory exam and scored 97% which I was pretty stoked with. The minimum score to pass is 90% so I managed to get that in the bag pretty easily. There is one more theoretical exam to do which is the <a href="http://en.wikipedia.org/wiki/Visual_flight_rules">VFR</a> exam. For that I am trying to learn all the abbreviations at the moment which might take a bit of time.</p>
<p>All in all the Christmas holidays turned out to have a decent amount of paragliding related activities.</p>
 
    </div>
</div>
    </div>

    <div id="post-spacer">
    <div id="post">
    <div id="post-header">
        <h2>
            
                <a href='/posts/2014-01-13_Integrating-Sherlock-with-a-build-server.html'>Sherlock configuration - Build server integration</a>
            
        </h2>
        <div id="post-meta">
            <p>
                Monday, January 13, 2014 | Posted in
                
                    <a id="post-category" href="/tags/sherlock.html">Sherlock</a>
                
                    <a id="post-category" href="/tags/jenkins.html">Jenkins</a>
                
                    <a id="post-category" href="/tags/teamcity.html">TeamCity</a>
                
                    <a id="post-category" href="/tags/msbuild.html">MsBuild</a>
                
            </p>
        </div>
    </div>
    <div id="post-content">
        <p>Once the configuration of <a href="/projects/sherlock.html">Sherlock</a> is complete the last step needed to make use of automatic regression testing is to integrate with a build server. In this post I will explain which steps need to be taken to integrate Sherlock with a build server. Examples will be given for <a href="http://jenkins-ci.org/">Jenkins</a>, which is used at my work, and <a href="http://www.jetbrains.com/teamcity/">TeamCity</a>, which I use personally. </p>
<p>In order to integrate with a build server you will need to: </p>
<ul>
<li>Create at least one test configuration</li>
<li>Write the build scripts necessary to register a test, wait for the completion of the test and process the results.</li>
<li>Set up a job on the build server to execute the test.  </li>
</ul>
<h3 id="test-configurations">Test configurations</h3>
<p>In order to execute a test the first thing you need to decide on is the test configuration which will be executed. In Sherlock the test configuration is described by a XML file similar to the following gist: </p>
<script src='https://gist.github.com/8346703.js'></script>

<p>In this configuration file replace all instances of <code>${SOME_TEXT}$</code> with the appropriate information. Note that some configuration settings should be templated so that those values can be supplied by the build system, e.g. the application version number:</p>
<ul>
<li>Provide an application name and version for use in the test report.</li>
<li>Provide a compact description. This will be used as the title of the test report</li>
<li>Provide each environment with a name. It doesn&#39;t matter what that name is as long as it is consistently used throughout the configuration file. All test steps which should be executed on the same environment should be linked to the same environment name. Note that while it is possible to request multiple environments to be started in a test, it is not possible to synchronize those environments. In other words each environment will exit as soon as it completes the test steps assigned to it, no environment will wait for other environments to complete their work.</li>
<li>For each test step that needs to be executed provide the order (integer number starting at 0, incrementing for each step), the name of the environment in which the step should be executed, the failure mode, either Stop or Continue and the correct file paths. Note that the test steps use the following definitions for their file paths:<ul>
<li><strong>msi:</strong> <code>file</code> is the absolute path to the MSI file as on the machine that is used to register the test (i.e. the origin).</li>
<li><strong>x-copy:</strong> <code>destination</code> is the absolute path to the directory that will hold all the x-copy results on the test environment.</li>
<li><strong>x-copy:</strong> <code>base</code> is the absolute path to the directory that holds the files / directories to be x-copied on the origin.</li>
<li><strong>x-copy:</strong> <code>paths</code> contains the absolute paths to the files / directories that should be x-copied. It is expected that these all reside in the <code>base</code> directory at some level.</li>
<li><strong>script:</strong> <code>file</code> is the absolute path to the script file on the origin.</li>
<li><strong>console:</strong> <code>exe</code> is the absolute path to the executable that should be executed on the test environment. Note that the path is also pointed to the test environment. Hence the <code>CONSOLE</code> test step is the only test step that doesn&#39;t copy files.</li>
<li><strong>All test steps:</strong> All files and directories that should be included in the report are absolute paths on the test environment.</li>
<li><strong>notification:</strong> The absolute path where the final report should be placed. This path should be accessible to both Sherlock (the master controller) and the application that will process the test results.</li>
</ul>
</li>
<li>It makes sense to always copy back any logs that are written during the test. If you don&#39;t need them for test failure diagnosis then it is easy to delete them later, however you can&#39;t copy them from the test environment after the test has completed because the test environment will be reset to its original state upon shut down. </li>
</ul>
<p>If you need tests to run in different environments or with different test steps then you will need to create a configuration file for each environment / set of test steps.  </p>
<h3 id="build-scripts">Build scripts</h3>
<p>The easiest way to execute the test from a build server is to create a set of build scripts that can do the work for you. In this example I will be using MsBuild as the scripting language.</p>
<p>In order to create the configuration file from the template it is necessary to replace all the templated configuration settings with their current values. The following gist shows an inline MsBuild task that does exactly that:</p>
<script src='https://gist.github.com/8277812.js?file=TemplateFile.xml'></script>

<p>In order to use this task create an <code>ItemGroup</code> with the identifiers of the settings and their replacement values. For example:</p>
<script src='https://gist.github.com/8277812.js?file=HowToUseTemplateFile.xml'></script>

<p>If this example is used on the following template file:</p>
<script src='https://gist.github.com/8277812.js?file=BeforeReplacement.xml'></script>

<p>Then the outcome is the following output file:</p>
<script src='https://gist.github.com/8277812.js?file=AfterReplacement.xml'></script>

<p>The next step will be to create a build script that can register the test with the Sherlock system. This can either be done with a call to the <a href="http://msdn.microsoft.com/en-us/library/x8zx72cd.aspx">exec</a> task or with the following inline MsBuild task:</p>
<script src='https://gist.github.com/8346876.js'></script>

<p>The next step is a little tricky in that it is now necessary to wait for Sherlock to execute the test and create the test report. The tricky bit due to the fact that Sherlock will only execute the tests when a suitable test environment is available. That means that tests could be executed almost immediately if an environment is directly available, or not for a long time if all environments are busy. On top of that MsBuild does not have the ability to watch specific files. The following inline task allows you to wait for certain files to be created. Note that you need to provide a time-out which determines how long this task will wait for the report files. How long this time-out should be depends on:</p>
<ul>
<li>How long it takes for the tests to execute.</li>
<li>How many tests will be executed on the same test environments. Tests executing on different test environments can be run in parallel provided the hardware will stand up to it.</li>
<li>How many other tests may potentially be executing at the same time.</li>
</ul>
<script src='https://gist.github.com/8346893.js'></script>

<p>Finally the report files need to be checked for success or failure. For each test Sherlock produces a HTML and an XML report. The easiest way to find the outcome of a test is to parse the XML report and search for the <code>result</code> element. The value of this element will either be <code>Passed</code> or <code>Failed</code>. The following inline task will accomplish this goal:</p>
<script src='https://gist.github.com/8346900.js'></script>

<h3 id="build-jobs">Build jobs</h3>
<p>The final task is to setup one or more build jobs for the build server to execute. While you can combine the testing steps with the build steps it is in general advisable to have a separate job for the testing steps. The main reason for that is that the the testing steps can take quite a while to execute, ranging from several minutes to hours, which slows down the continuous integration feedback cycle considerably. Based on the idea that the tests should be contained in their own build job the following set-up is proposed. </p>
<ul>
<li>Define three different build jobs for the build, test and deploy stages of the process. This means that each job will be responsible for a specific task. Individual jobs will be use the artefacts produced by the other jobs.</li>
<li>Set up dependencies between the different builds where required. For instance the test job will depend on the artefacts produced by the build job.</li>
<li>The build job can be run both as continuous integration build, i.e. execute the build job each time a commit to the source control system is detected, and as pre-requisite to the test job.</li>
<li>Similarly the test job could be run nightly to provide relatively quick feedback on regression problems while also acting as pre-requisite to the deploy job. </li>
<li>If the version number includes either the build counter of the build job or the revision number of the source control commit then special care needs to be taken for the test and deploy jobs in order to ensure that they get the same numbers as the build job did.</li>
<li>In a similar fashion it will be necessary to control the version control settings so that all builds pull in the same revision. One solution would be to store the revision index in the first job in the chain and then transfer that to the other jobs.</li>
</ul>
<p>For the two build systems I have specifically worked with the following additional notes can be made:</p>
<ul>
<li><a href="http://jenkins-ci.org/">Jenkins</a><ul>
<li>In addition to the three standard jobs you will probably need a <a href="https://wiki.jenkins-ci.org/display/JENKINS/Build+Flow+Plugin">Build flow</a> job to trigger the different standard jobs in the right order. This has to be done because at the moment it does not seem possible in Jenkins to trigger pre-requisite builds without having the downstream project taking up one of the build executors. The build flow jobs live outside the actual build executors which makes it possible to optimize the use of the executors.</li>
<li>In order to deal with the build number problems as specified above the simplest way is to write the number to a file in the upstream job, archive that and then pull it out in the downstream jobs. The same goes for the version control information.</li>
</ul>
</li>
<li><a href="http://www.jetbrains.com/teamcity/">TeamCity</a><ul>
<li>Downstream jobs have both a snapshot dependency and an artefact dependency on the upstream job. The <a href="http://confluence.jetbrains.com/display/TCD8/Configuring+Dependencies">snapshot dependency</a> takes care of the synchronization of the version control revision. Note that you should create different VCS roots for each project, otherwise the projects all share a single check-out directory. By sharing a single directory it is possible that upon starting the second job the directory is cleaned which will likely remove the artefacts from the first job. </li>
<li>The build number can be copied easily by <a href="http://confluence.jetbrains.com/display/TCD8/Configuring+General+Settings#ConfiguringGeneralSettings-BuildNumberFormat">synchronizing</a> the build numbers.</li>
</ul>
</li>
</ul>
 
    </div>
</div>
    </div>


<!-- Page Listing -->

    <div class="pagination">
        <!-- Previous Page Button -->
        
            <a class="navlinks-prev" href="/index.3.html">Older</a>
        

        <!-- Next Page Button -->
        
            <a class="navlinks-next" href="/index.1.html">Newer</a>
        
    </div>

        </div>
    </div>
    <div id="footer" class="container">
        <div id="fbox1">
            <h2>Related</h2>

<ul>
    <li id="first"><a href="https://github.com/pvandervelde">GitHub</a></li>
    <li><a href="http://www.linkedin.com/profile/view?id=33950311">LinkedIn</a></li>
    <li><a href="http://stackoverflow.com/users/539846/petrik">StackOverflow</a></li>
    <li><a href="http://careers.stackoverflow.com/pvandervelde">StackOverflow Careers</a></li>
    <li><a href="https://plus.google.com/+PatrickvanderVelde/about">Google+</a></li>
</ul>
        </div>
        <div id="fbox2">
            <h2 id="copyright">Copyright</h2>
<p>Copyright (c) 2013 <a href="http://www.petrikvandervelde.nl">http://www.petrikvandervelde.nl</a>. All rights reserved.</p>
<h2 id="disclaimer">Disclaimer</h2>
<p>The opinions expressed herein are my own personal opinions and do not represent my employer&#39;s view in any way.</p>

        </div>
        <div id="fbox3">
            <h2 id="media">Media</h2>
<p><a href="/atom.xml"><img src="/images/feed.png" alt="Atom feed"></a></p>

        </div>
    </div>
    <div id="copyright" class="container">
        <p>
            Site design based on the <a href="http://www.freecsstemplates.org/previews/opentools/">Open Tools</a> design 
            by <a href="http://www.freecsstemplates.org">FreeCSSTemplates.org</a>.
        </p>
        <p>
            Feed icon by <a href="http://www.icojam.com/">Icojam</a> and Favicon by 
            <a href="http://www.flaticon.com/free-icon/twister-sky-wind_12318" title="Yannick">Yannick</a> 
            from <a href="http://www.flaticon.com" title="Flaticon">www.flaticon.com</a>
        </p>
        <p>Generated by <a href="http://docpad.org/" rel="nofollow">DocPad</a> on Thursday, October 02, 2014.</p>
    </div>

    <!-- jQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/vendor/jquery.js"><\/script>')</script>

    <!-- DocPad Scripts + Our Own -->
    <script >(function(){
	/* Did we just livereload? */
var log = !!(localStorage && console && console.log && true);
if ( log && localStorage.getItem('/docpad-livereload/reloaded') === 'yes' ) {
	localStorage.removeItem('/docpad-livereload/reloaded');
	console.log('LiveReload completed at', new Date())
}

/* Listen for the regenerated event and perform a reload of the page when the event occurs */
var listen = function(){
	var primus = new Primus('/docpad-livereload');
	primus.on('data', function(data){
		if ( data && data.message ) {
			if ( data.message === 'generateBefore' ) {
				if ( log ) {
					console.log('LiveReload started at', new Date());
				}
				if ( typeof document.getElementsByTagName !== 'undefined' ) {
	document.getElementsByTagName('html')[0].className += ' wait';
}
			}
			else if ( data.message === 'generateAfter' ) {
				if ( log ) {
					localStorage.setItem('/docpad-livereload/reloaded', 'yes');
				}
				document.location.reload();
			}
		}
	});
};
	/* Inject socket into our page */
var inject = function(){
	var t = document.createElement('script');
	t.type = 'text/javascript';
	t.async = 'async';
	t.src = '/primus/primus.js';
	t.onload = listen;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(t, s);
};
	if ( typeof Primus !== 'undefined' ) {
		listen();
	} else {
		inject();
	}
})();</script><script >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-46605109-1');
ga('send', 'pageview');</script><script defer="defer"  src="/vendor/log.js"></script><script defer="defer"  src="/vendor/modernizr.js"></script><script defer="defer"  src="/scripts/script.js"></script>
</body>
</html>