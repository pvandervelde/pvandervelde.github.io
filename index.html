
<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

    <title>Mind vortex - Home</title>
    <meta name="description" content="Welcome!" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link type="application/rss+xml" rel="alternate" title="Mind vortex" href="/feed.rss" />
    <link type="application/atom+xml" rel="alternate" title="Mind vortex" href="/feed.atom" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <link href="/assets/css/normalize.css" rel="stylesheet" />
    <link href="/assets/css/h5bp.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href="/assets/css/override.css" rel="stylesheet" />
    <link href="/assets/css/github.css" rel="stylesheet" type="text/css">


    <meta name="application-name" content="Mind vortex" />
    <meta name="msapplication-tooltip" content="Mind vortex" />
    <meta name="msapplication-starturl" content="/" />

    <meta property="og:title" content="Mind vortex - Home" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.petrikvandervelde.nl/" />
    <!-- TODO: More social graph meta tags -->

    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/highlight.pack.js"></script>
    <script src="/assets/js/clean-blog.js"></script>
    <script src="/assets/js/d3.v3.min.js"></script>
    <script src="/assets/js/trianglify.min.js"></script>
    <script src="/assets/js/Please-compressed.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
            <script src="/assets/js/html5shiv.js"></script>
            <script src="/assets/js/respond.min.js"></script>
    <![endif]-->

    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->
        <div id="header" class="container">
            <div id="logo">
                <h1><a href="/">Mind vortex</a></h1>
            </div>
            <div id="menu">
                <ul>
                                <li class="active" >
                Home
            </li>
            <li class="inactive" >
                <a href="/projects">Projects</a>
            </li>
            <li class="inactive" >
                <a href="/posts">Archive</a>
            </li>
            <li class="inactive" >
                <a href="/about">About</a>
            </li>

                </ul>
            </div>
        </div>

        <div id="page" class="container">
            <div id="sidebar">
                <div id="sbox1">
                    <h2>Patrick van der Velde</h2>

<p>
    <img src="http://www.gravatar.com/avatar/9bc8b3ff385cd14f2b12138c97729df2?s=160" alt="Gravatar for Patrick van der Velde">
</p>
<p>
    Dutch software developer, living, working and playing in New Zealand.
    Rock climber, and paragliding pilot. Developer of
    <a href="http://nbuildkit.github.io/nBuildKit.MsBuild/">nBuildKit</a>,
    <a href="https://github.com/Calvinverse">the Calvinverse resources</a> and other projects
</p>
<p>
    <a href="/about.html">More ...</a>
</p>

                </div>
                <div id="sbox2">
                    <h2>Recent</h2>
                    <ul class="list-unstyled">
                            <li><a href="/posts/Software-development-pipeline-Design-performance">Software development pipeline - Design performance</a></li>
                            <li><a href="/posts/Exportable-Linux-virtual-hard-drives-for-hyper-v">Exportable Linux virtual hard-drives for Hyper-V</a></li>
                            <li><a href="/posts/Software-development-pipeline-Design-accuracy">Software development pipeline - Design accuracy</a></li>
                            <li><a href="/posts/nBuildkit-Release-V0102">nBuildKit release - V0.10.2</a></li>
                            <li><a href="/posts/Software-development-pipeline-Design-introduction">Software development pipeline - Design introduction</a></li>
                            <li><a href="/posts/nBuildkit-release-V0100">nBuildKit release - V0.10.0</a></li>
                            <li><a href="/posts/Ops-Tools-Build-release-V030">Ops-Tools-Build release - V0.3.0</a></li>
                            <li><a href="/posts/Ops-Tools-Build-release-V020">Ops-Tools-Build release - V0.2.0</a></li>
                            <li><a href="/posts/nBuildKit-release-V092">nBuildKit release - V0.9.2</a></li>
                            <li><a href="/posts/nBuildKit-release-V091">nBuildKit release - V0.9.1</a></li>
                    </ul>
                </div>
                <div id="sbox3">
                    <h2>Tags</h2>
                    <div>
                        <ul class="list-unstyled">
                                <li>
                                    <a role="button" href="/tags/sherlock" class="btn btn-default btn-sm"> Sherlock (13)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/nbuildkit" class="btn btn-default btn-sm"> nBuildKit (12)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/pg2" class="btn btn-default btn-sm"> PG2 (9)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/paragliding" class="btn btn-default btn-sm"> Paragliding (9)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/blog" class="btn btn-default btn-sm"> Blog (7)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/nuclei" class="btn btn-default btn-sm"> Nuclei (6)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/nanicitus" class="btn btn-default btn-sm"> nAnicitus (5)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/software-development-pipeline" class="btn btn-default btn-sm"> Software development pipeline (3)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/delivering-software" class="btn btn-default btn-sm"> Delivering software (3)</a>
                                </li>
                                <li>
                                    <a role="button" href="/tags/pipeline-design" class="btn btn-default btn-sm"> Pipeline design (3)</a>
                                </li>
                        </ul>
                    </div>
                    <br />
                    <ul class="pager">
                        <li class="next">
                            <a href="/tags">View All Tags &rarr;</a>
                        </li>
                    </ul>
                </div>
            </div>

            <div id="content">

        <div id="post-spacer">
            <div id="post">
                <div id="post-header">
                    <!--
    Model is: Tuple<IDocument, IDocument>.
    The first one is the current document that is being rendered, the second one is the one for which the post header should be rendered.
-->


<h2>
            <a href="/posts/Software-development-pipeline-Design-performance">Software development pipeline - Design performance</a>
</h2>
<div id="post-meta">
    <p>
Sunday, November 5, 2017
 |         Posted in                     <a id="post-category" role="button" href="/tags/delivering-software" class="btn btn-default btn-xs">Delivering software</a>
                    <a id="post-category" role="button" href="/tags/devops" class="btn btn-default btn-xs">DevOps</a>
                    <a id="post-category" role="button" href="/tags/pipeline-design" class="btn btn-default btn-xs">Pipeline design</a>
                    <a id="post-category" role="button" href="/tags/software-development-pipeline" class="btn btn-default btn-xs">Software development pipeline</a>
    </p>
</div>

                </div>
                <div id="post-content">
                    <p>The <a href="Software-development-pipeline-Design-introduction.html">second property</a> to consider is
<em>performance</em>, which in this case means that the pipeline should provide feedback on the quality of
the current input set as soon as possible in order to reduce the length of the feedback cycle. As is
<a href="https://www.richard-banks.org/2013/04/why-short-feedback-cycle-is-good-thing.html">known</a>
<a href="http://www.ambysoft.com/essays/whyAgileWorksFeedback.html">having</a> a short
<a href="https://continuousdelivery.com/2012/08/why-software-development-methodologies-suck/">feedback</a>
cycle makes it easier for the development teams to make improvements and fix issues.</p>
<p>There are two main components to development pipeline performance:</p>
<ul>
<li>How quickly can one specific input set be processed completely by the pipeline. In other words
how much time does it take to push a single input set through the pipeline from the initial change
to the delivery of the final artefacts. This depends on the number of steps in the development
pipeline and how quickly each step can be executed.</li>
<li>How quickly can a large set of input sets be processed. The maximum number of executors will most
likely be limited to some maximum value. The pipeline is limited in the number of simultaneous
input sets it can process by the number of available executors. How quickly the pipeline can
process large number of input sets depends both on the time necessary to process a single input set
and the relation between the total number of input sets and the number of executors</li>
</ul>
<p>Optimizing the combination of these two components will lead to a development pipeline which is
designed for maximum throughput for the development team. One important note to make is that a high
performing pipeline will not not necessarily be the most resource efficient pipeline. For instance
the development pipeline may only be fully loaded a few times a week. From a resource perspective
the pipeline components are more than capable of dealing with the load, in fact the components may
even be oversized. However because one of the main goals of the pipeline is to deliver fast feedback
to the development teams the actual sizing of the pipeline and its components depends more on the
way the pipeline will be loaded over time, e.g. will the jobs come as a constant stream or in
blocks, will the jobs be small or large or will it be a mixture of both. In some cases the loading
pattern can be accurately predicted while in other cases it is completely unpredictable.
In general the pattern will depend on the workflow followed by the development team and the geographical
distribution of the team. For instance when the team follows the Scrum methodology it is
likely, though not necessary, that there will be more builds in the middle of the sprint than at the
start or end. On the other hand when using the Kanban methodology the load on the system should be
fairly consistent. Additionally geographical distribution of the development team influences the
times that the pipeline will be loaded. If all of the team is in a single geographical location then
higher loads can be expected during the day while lighter loads are be expected during the evening
and night. However if the team is distributed across the globe it is more likely that the loading will
be more consistent across the day due to the fact that the different locations have &lsquo;office hours&rsquo; at
different times in the day, as seen from the perspective of the different servers which are part of
the development pipeline. Taking these issues into account when sizing the capacity of the development
pipeline may lead to increasing the capacity of the pipeline because the the current peak loading
during working hours results in wait times which are too large.</p>
<p>With this high level information it is possible to start improving the performance of the development
pipeline. This obviously leads to the question: &ldquo;What practical steps can we take&rdquo;. As per normal when
dealing with performance improvements it is hard to provide solutions because these depend
on the specific situation. It is however possible to provide some more general advise.</p>
<p>The very first step to take when dealing with performance is always to measure everything. In the case
of the development pipeline it will be useful to gather metrics constantly and to automatically process
these metrics into several key performance indicators, e.g. the number of input sets per time span, which
describes the loading pattern, the waiting times for each input set before it is processed and the
time taken to process each input set. These key performance indicators can then be used to keep
track of performance improvements as changes are made to the pipeline.</p>
<p>One important issue to keep in mind with regards to performance is that unlike with accuracy performance
may change over time even if there are no <em>changes</em> to the system because the performance of the
underlying infrastructure might change, for instance when disks fill up, the network load changes or
the hardware ages. This means it will be important to track performance trends over longer periods of
time to average out the influences of temporary infrastructure changes, e.g. network loading.</p>
<p>With all that out of the way some of the standard steps that can be taken are:</p>
<ul>
<li>Each pipeline stage should only perform the necessary steps to achieve the desired goal. This for
instance means that partial builds are better than full rebuilds, from a performance perspective.</li>
<li>Only gather data that will be used during the current stage. Gathering data that is not required
wastes time, thus smaller input sets are quicker to process.</li>
<li>When pulling data locality matters. Pulling data off the local disk is faster than pulling it off
the network, pulling data off the local network is faster than pulling it from the WAN or the internet.
Additionally data that is not local should be cached so that it only needs to be retrieved once.</li>
<li>Ensure that pipeline stages run on suitable &lsquo;hardware&rsquo;, either physical or virtual. Ideally the
stage is executed on hardware that is optimized for the performance demands of the step, e.g.
execute I/O bound steps on hardware that has fast I/O etc.</li>
</ul>
<p>In addition to these improvements it will be important to review and improve the ability of the
pipeline to execute many input sets in parallel.</p>
<ul>
<li>Ensure that the pipeline applications which deal with the distribution of input sets are efficient
at this task. It's not very useful to start processing an input set only to find out that there
are no executors which can process this given input set (I'm looking at you TFS2013).</li>
<li>Splitting a single stage into multiple parallel stages will improve throughput for a single input
set. However it might decrease overall throughput due to the fact that a single input set requires
the use of multiple executors. Note that splitting a single stage into many parallel stages might
lead to reductions in performance due to the overhead of transitioning between stages.</li>
</ul>
<p>The mentioned improvements form a start for improving the performance of the pipeline. Depending on
the specific characteristics of a given pipeline other improvements and design choices may be valid.</p>
<p>Finally it must be mentioned that some performance improvements will have negative influences on the
other <a href="Software-development-pipeline-Design-introduction.html">properties</a>. For instance using partial
builds may influence accuracy. In the end a trade-off will need to be made when it comes to changes
that influence multiple properties.</p>

                </div>
            </div>
        </div>
        <div id="post-spacer">
            <div id="post">
                <div id="post-header">
                    <!--
    Model is: Tuple<IDocument, IDocument>.
    The first one is the current document that is being rendered, the second one is the one for which the post header should be rendered.
-->


<h2>
            <a href="/posts/Exportable-Linux-virtual-hard-drives-for-hyper-v">Exportable Linux virtual hard-drives for Hyper-V</a>
</h2>
<div id="post-meta">
    <p>
Thursday, September 14, 2017
 |         Posted in                     <a id="post-category" role="button" href="/tags/hyper-v" class="btn btn-default btn-xs">Hyper-V</a>
                    <a id="post-category" role="button" href="/tags/preseed" class="btn btn-default btn-xs">Preseed</a>
                    <a id="post-category" role="button" href="/tags/ubuntu" class="btn btn-default btn-xs">Ubuntu</a>
                    <a id="post-category" role="button" href="/tags/unattend" class="btn btn-default btn-xs">Unattend</a>
    </p>
</div>

                </div>
                <div id="post-content">
                    <p>As part of learning more about infrastructure creation, testing and deployment one of the projects
I'm working on is creating a set of virtual machine images for <a href="https://github.com/Calvinverse/base.windows">Windows</a>
and <a href="https://github.com/Calvinverse/base.linux">Linux</a> which can be used as a base for more complex
virtual machine based resources, e.g. <a href="https://github.com/Calvinverse/resource.hashi.server">a consul host</a>
or <a href="https://github.com/Calvinverse/resource.container.host.linux">a docker host</a>.</p>
<p>The main virtualization technology I use is Hyper-V on both Windows 10 and Windows 2016 which allows
creating <a href="https://technet.microsoft.com/en-us/library/dn282285(v=ws.11).aspx">Generation 2</a> virtual machines.
Some of the
<a href="https://docs.microsoft.com/en-us/windows-server/virtualization/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v">benefits of a generation 2</a>
virtual machine are:</p>
<ul>
<li>Boot volume up to 64 Tb</li>
<li>Use of <a href="https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface">UEFI</a> for the boot process</li>
<li>Faster boot</li>
</ul>
<p>The initial version of the base resources allowed creating a virtual machine with
<a href="https://packer.io">Packer</a> and exporting that virtual machine to be used as a base. However ideally
all one would need is the virtual hard-drive. The virtual machine configuration can easily be
created for each individual resource and the configuration is usually specific to the original
host by virtue of it containing the absolute path of the virtual hard drive, the name of the network
interfaces etc..</p>
<p>When building Ubuntu virtual disk images one of the issues with using a Generation 2 virtual machine is that
it uses UEFI for the boot process. It turns out that the Ubuntu install process stores the UEFI files
in the <a href="https://blogs.msdn.microsoft.com/virtual_pc_guy/2015/02/11/copying-the-vhd-of-a-generation-2-linux-vmand-not-booting-afterwards/">virtual machine configuration file</a>.
This means that when one creates a new virtual machine from the base virtual disk image it runs into
a problem when booting because the boot files are not present in the new machine. The result is this</p>
<p><img align="center" alt="Hyper-V error message due to missing UEFI sector" src="/assets/images/infrastructure/hyperv-gen2-ubuntu-missing-uefi-sector-result.png" /></p>
<p>The solution to this issue obviously is to force the Ubuntu installer to write the UEFI files to the
virtual hard disk which can be achieved by adding the correct configuration values to the
<a href="https://help.ubuntu.com/lts/installation-guide/armhf/apb.html">preseed file</a>. Unfortunately the
documentation for the different options in the preseed files is hard to find. In the end a combination
of the <a href="https://help.ubuntu.com/lts/installation-guide/example-preseed.txt">ubuntu sample preseed</a> file,
bug reports, old forum messages and a few blog
<a href="https://blog.jhnr.ch/2017/02/23/resolving-no-x64-based-uefi-boot-loader-was-found-when-starting-ubuntu-virtual-machine/">posts</a>
allowed me to determine that to make the Ubuntu installer place the UEFI files in the correct location
two parts of the preseed file needed to be changed from the default Ubuntu one. The first
part is the partitioning section which requires that at least an <code>EFI</code> partition and (most likely)
a <code>boot</code> partition are defined. This almost requires that a custom recipe is defined. The one
I currently use looks as follows:</p>
<pre><code># Or provide a recipe of your own...
# If not, you can put an entire recipe into the preconfiguration file in one
# (logical) line. This example creates a small /boot partition, suitable
# swap, and uses the rest of the space for the root partition:
d-i partman-auto/expert_recipe string       \
    grub-efi-boot-root ::                   \
        1 1 1 free                          \
            $bios_boot{ }                   \
            method{ biosgrub }              \
        .                                   \
        256 256 256 fat32                   \
            $primary{ }                     \
            method{ efi }                   \
            format{ }                       \
        .                                   \
        512 512 512 ext4                    \
            $primary{ }                     \
            $bootable{ }                    \
            method{ format }                \
            format{ }                       \
            use_filesystem{ }               \
            filesystem{ ext4 }              \
            mountpoint{ /boot }             \
        .                                   \
        4096 4096 4096 linux-swap           \
            $lvmok{ }                       \
            method{ swap }                  \
            format{ }                       \
        .                                   \
        10000 20000 -1 ext4                 \
            $lvmok{ }                       \
            method{ format }                \
            format{ }                       \
            use_filesystem{ }               \
            filesystem{ ext4 }              \
            mountpoint{ / }                 \
        .
</code></pre>
<p>Note that syntax for the partioner section is very particular. Note especially the  dots (<code>.</code>) at
the end of each section. If the syntax isn't completely correct nothing will work but no sensible
error messages will be provided.
Additionally the Ubuntu install complained when there was no <code>swap</code> section so I added one. This
shouldn't be necessary to get the UEFI files in the correct location but it is apparently necessary
to get Ubuntu to install in the first place.</p>
<p>The second part of the preseed file that should be changed is the <code>grub-installer</code> section. There
the following line should be added</p>
<pre><code>d-i grub-installer/force-efi-extra-removable boolean true
</code></pre>
<p>This line indicates that grub should force install the UEFI files, thus overriding the normal state
of not installing the UEFI boot files.</p>
<p>This means that the complete preseed file looks as follows</p>
<pre><code># preseed configuration file for Ubuntu.
# Based on: https://help.ubuntu.com/lts/installation-guide/armhf/apbs04.html

#
# *** Localization ***
#
# Originally from: https://help.ubuntu.com/lts/installation-guide/armhf/apbs04.html#preseed-l10n
#

# Preseeding only locale sets language, country and locale.
d-i debian-installer/locale string en_US.utf8

# Keyboard selection.
# Disable automatic (interactive) keymap detection.
d-i console-setup/ask_detect boolean false
d-i console-setup/layout string us

d-i kbd-chooser/method select American English

#
# *** Network configuration ***
#
# Originally from: https://help.ubuntu.com/lts/installation-guide/armhf/apbs04.html#preseed-network
#

# netcfg will choose an interface that has link if possible. This makes it
# skip displaying a list if there is more than one interface.
d-i netcfg/choose_interface select auto

# If you want the preconfiguration file to work on systems both with and
# without a dhcp server, uncomment these lines and the static network
# configuration below.
d-i netcfg/dhcp_failed note ignore
d-i netcfg/dhcp_options select Configure network manually

# Any hostname and domain names assigned from dhcp take precedence over
# values set here. However, setting the values still prevents the questions
# from being shown, even if values come from dhcp.
d-i netcfg/get_hostname string unassigned-hostname
d-i netcfg/get_domain string unassigned-domain

# Disable that annoying WEP key dialog.
d-i netcfg/wireless_wep string


#
# *** Account setup ***
#
# Originally from: https://help.ubuntu.com/lts/installation-guide/armhf/apbs04.html#preseed-account
#

# To create a normal user account.
d-i passwd/user-fullname string localadmin
d-i passwd/username string localadmin

# Normal user's password, either in clear text
d-i passwd/user-password password reallygoodpassword
d-i passwd/user-password-again password reallygoodpassword

# The installer will warn about weak passwords. If you are sure you know
# what you're doing and want to override it, uncomment this.
d-i user-setup/encrypt-home boolean false
d-i user-setup/allow-password-weak boolean true

# Set to true if you want to encrypt the first user's home directory.
d-i user-setup/encrypt-home boolean false


#
# *** Clock and time zone setup ***
#
# Originally from: https://help.ubuntu.com/lts/installation-guide/armhf/apbs04.html#preseed-time
#

# Controls whether or not the hardware clock is set to UTC.
d-i clock-setup/utc boolean true
d-i clock-setup/utc-auto boolean true

# You may set this to any valid setting for $TZ; see the contents of
# /usr/share/zoneinfo/ for valid values.
d-i time/zone string UTC


#
# *** Partitioning ***
#
# Originally from: https://help.ubuntu.com/lts/installation-guide/armhf/apbs04.html#preseed-partman
#

# This makes partman automatically partition without confirmation, provided
# that you told it what to do using one of the methods below.
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

# In addition, you'll need to specify the method to use.
# The presently available methods are:
# - regular: use the usual partition types for your architecture
# - lvm:     use LVM to partition the disk
# - crypto:  use LVM within an encrypted partition
d-i partman-auto/method string lvm
d-i partman-auto/purge_lvm_from_device boolean true

# If one of the disks that are going to be automatically partitioned
# contains an old LVM configuration, the user will normally receive a
# warning. This can be preseeded away...
d-i partman-lvm/device_remove_lvm boolean true
d-i partman-lvm/device_remove_lvm_span boolean true

# And the same goes for the confirmation to write the lvm partitions.
d-i partman-lvm/confirm boolean true
d-i partman-lvm/confirm_nooverwrite boolean true

# For LVM partitioning, you can select how much of the volume group to use
# for logical volumes.
d-i partman-auto-lvm/guided_size string max
d-i partman-auto-lvm/new_vg_name string system

# You can choose one of the three predefined partitioning recipes:
# - atomic: all files in one partition
# - home:   separate /home partition
# - multi:  separate /home, /usr, /var, and /tmp partitions
d-i partman-auto/choose_recipe select grub-efi-boot-root

d-i partman-partitioning/confirm_write_new_label boolean true

# If you just want to change the default filesystem from ext3 to something
# else, you can do that without providing a full recipe.
d-i partman/default_filesystem string ext4

# Or provide a recipe of your own...
# If not, you can put an entire recipe into the preconfiguration file in one
# (logical) line. This example creates a small /boot partition, suitable
# swap, and uses the rest of the space for the root partition:
d-i partman-auto/expert_recipe string       \
    grub-efi-boot-root ::                   \
        1 1 1 free                          \
            $bios_boot{ }                   \
            method{ biosgrub }              \
        .                                   \
        256 256 256 fat32                   \
            $primary{ }                     \
            method{ efi }                   \
            format{ }                       \
        .                                   \
        512 512 512 ext4                    \
            $primary{ }                     \
            $bootable{ }                    \
            method{ format }                \
            format{ }                       \
            use_filesystem{ }               \
            filesystem{ ext4 }              \
            mountpoint{ /boot }             \
        .                                   \
        4096 4096 4096 linux-swap           \
            $lvmok{ }                       \
            method{ swap }                  \
            format{ }                       \
        .                                   \
        10000 20000 -1 ext4                 \
            $lvmok{ }                       \
            method{ format }                \
            format{ }                       \
            use_filesystem{ }               \
            filesystem{ ext4 }              \
            mountpoint{ / }                 \
        .

d-i partman-partitioning/no_bootable_gpt_biosgrub boolean false
d-i partman-partitioning/no_bootable_gpt_efi boolean false

# enforce usage of GPT - a must have to use EFI!
d-i partman-basicfilesystems/choose_label string gpt
d-i partman-basicfilesystems/default_label string gpt
d-i partman-partitioning/choose_label string gpt
d-i partman-partitioning/default_label string gpt
d-i partman/choose_label string gpt
d-i partman/default_label string gpt

# Keep that one set to true so we end up with a UEFI enabled
# system. If set to false, /var/lib/partman/uefi_ignore will be touched
d-i partman-efi/non_efi_system boolean true


#
# *** Package selection ***
#
# originally from: https://help.ubuntu.com/lts/installation-guide/armhf/apbs04.html#preseed-pkgsel
#

tasksel tasksel/first multiselect standard, ubuntu-server

# Minimum packages (see postinstall.sh). This includes the hyper-v tools
d-i pkgsel/include string openssh-server ntp linux-tools-$(uname -r) linux-cloud-tools-$(uname -r) linux-cloud-tools-common

# Upgrade packages after debootstrap? (none, safe-upgrade, full-upgrade)
# (note: set to none for speed)
d-i pkgsel/upgrade select none

# Policy for applying updates. May be &quot;none&quot; (no automatic updates),
# &quot;unattended-upgrades&quot; (install security updates automatically), or
# &quot;landscape&quot; (manage system with Landscape).
d-i pkgsel/update-policy select none

# Language pack selection
d-i pkgsel/install-language-support boolean false

#
# Boot loader installation
#

# This is fairly safe to set, it makes grub install automatically to the MBR
# if no other operating system is detected on the machine.
d-i grub-installer/only_debian boolean true

# This one makes grub-installer install to the MBR if it also finds some other
# OS, which is less safe as it might not be able to boot that other OS.
d-i grub-installer/with_other_os boolean true

# Alternatively, if you want to install to a location other than the mbr,
# uncomment and edit these lines:
d-i grub-installer/bootdev string /dev/sda
d-i grub-installer/force-efi-extra-removable boolean true


#
# *** Preseed other packages ***
#

d-i debconf debconf/frontend select Noninteractive
d-i finish-install/reboot_in_progress note

choose-mirror-bin mirror/http/proxy string
</code></pre>
<p>The complete preseed file can also be found in the
<a href="https://github.com/ops-resource/ops-tools-baseimage/tree/master/src/linux/ubuntu/http">http preseed directory</a>
of the <a href="https://github.com/ops-resource/ops-tools-baseimage">Ops-Tools-BaseImage</a> project. This
project also publishes a <a href="https://www.nuget.org/packages/Ops.Tools.BaseImage.Linux/">NuGet</a> package
which has all the configuration files and scripts that were used to create the Ubuntu base virtual
hard drive.</p>

                </div>
            </div>
        </div>
        <div id="post-spacer">
            <div id="post">
                <div id="post-header">
                    <!--
    Model is: Tuple<IDocument, IDocument>.
    The first one is the current document that is being rendered, the second one is the one for which the post header should be rendered.
-->


<h2>
            <a href="/posts/Software-development-pipeline-Design-accuracy">Software development pipeline - Design accuracy</a>
</h2>
<div id="post-meta">
    <p>
Monday, September 4, 2017
 |         Posted in                     <a id="post-category" role="button" href="/tags/delivering-software" class="btn btn-default btn-xs">Delivering software</a>
                    <a id="post-category" role="button" href="/tags/devops" class="btn btn-default btn-xs">DevOps</a>
                    <a id="post-category" role="button" href="/tags/pipeline-design" class="btn btn-default btn-xs">Pipeline design</a>
                    <a id="post-category" role="button" href="/tags/software-development-pipeline" class="btn btn-default btn-xs">Software development pipeline</a>
    </p>
</div>

                </div>
                <div id="post-content">
                    <p><a href="https://en.wikipedia.org/wiki/Accuracy_and_precision#ISO_definition_.28ISO_5725.29">ISO</a> defines
accuracy as the combination of <a href="http://dictionary.cambridge.org/dictionary/english/correct?q=correctness">correctness</a>,
in agreement with the true facts, and <a href="http://dictionary.cambridge.org/dictionary/english/consistency">consistency</a>,
always behaving or performing in a similar way.</p>
<p>The reason to value <em>accuracy</em> as the number one characteristic of the development pipeline is
because it is important for the development teams to be able to rely on the outputs of the
pipeline, whether they are product artefacts, test results or output logs. Without the accuracy
the development teams will eventually lose their trust in the development pipeline, meaning that
they will start ignoring the results because the teams assume that a failure is one of the system
instead of one caused by the input set. Once the development teams lose the trust in the
pipeline it will take a lot of work to regain their trust.</p>
<p>Once we know that having a development pipeline which delivers correct results is important the
next step is to determine how accuracy can be built into the development pipeline.
In theory this task is a simple one, all one has to do is to ensure that all the parts that form the
pipeline behave correctly for all input sets. However as indicated by
<a href="http://wiki.c2.com/?DifferenceBetweenTheoryAndPractice">many</a> -</p>
<blockquote class="blockquote">
<p>In theory there is no difference between theory and practice. In practice there is</p>
</blockquote>
<p>which means that practically achieving accuracy is a difficult task due to the
many, often complex, interactions between the pipeline components. As a reminder
the <a href="Software-development-pipeline-Design-introduction.html">components</a> the
development pipeline consists of are:</p>
<ul>
<li>The scripts that are used during the different parts of the cycle, i.e. the build, test
and release scripts.</li>
<li>The continuous integration system which is used to execute the different scripts.</li>
<li>The tools, like the compiler, test frameworks, etc.</li>
</ul>
<p>Based on this categorization of the pipeline parts and the previous statement one possible
way of approaching accuracy for a development pipeline is to first ensure that all the parts
are individually accurate. As a second stage the changes in accuracy due to interaction between
the parts can be dealt with.</p>
<p>For the scripts, tools and continuous integration system this means that each input returns a
correct response and does so consistently for each input set. Fortunately most scripts
and tools do so for the majority of the inputs. In cases where a tool returns an incorrect response
the standard software development process should be followed by recording an issue, scheduling the
issue and implementing, testing and deploying a new version of the tool. In this process
it is important to test thoroughly to ensure that the changes do not negatively impact
tool accuracy. Additionally it is important to execute both (automated) regression testing against known
input sets as well as high level (automated) smoke tests of the entire development pipeline
to validate that the issue has been fixed and no further issues have been introduced.
In order to minimize disruption to the development teams tests should be conducted outside
business hours if no test environment is available, i.e. if the production development
pipeline has to be used for the final tests. It is of course better if a test environment
is available so that testing can take place during business hours without affecting
the development teams. As a side note; having a test environment with a copy of the
development pipeline allows for the development of new features and other changes
while the production pipeline is in use, thus making it easier and quicker to evolve
the pipeline and its capabilities.</p>
<p>With the approach to development and improvement of the tools taken care of the other area that
needs to be carefully controlled is the infrastructure on top of which the development pipeline
executes. For infrastructure the biggest issues are related to outages of different parts of
the infrastructure, e.g. the network or the different services. In most cases
failures on the infrastructure level do not directly influence the correctness of the development
pipeline. It is obviously possible for a failure in the infrastructure to lead
to an incorrect service being used, e.g. the test package manager instead of the
production one. However unless other issues are present, i.e. the test package manager
has packages of the same version but different content, it is unlikely that
a failure in the infrastructure will allow artefacts to pass the development pipeline
while they should not. A more likely result is that failures in the infrastructure
lead to failures in the development pipeline thus affecting the ability of the
pipeline to deliver the correct results consistently.</p>
<p>The types of issues mentioned can mostly be prevented by using the modern approaches
to IT operations like <a href="https://en.wikipedia.org/wiki/Software_configuration_management">configuration management</a>
and <a href="https://martinfowler.com/bliki/ImmutableServer.html">immutable servers</a> to ensure
that the state of the infrastructure is known, <a href="https://en.wikipedia.org/wiki/System_monitor">monitoring</a>
to ensure that those responsible for operations are notified of issues and
standard operating procedures and potentially auto-remediation scripts to
quickly resolve issues that arise.</p>
<p>It should be noted that it is not necessary, though extremely helpful, for the infrastructure
to be robust in order to provide an accurate development pipeline. Tooling can, and
probably should, be adapted to handle and correct for infrastructure failures as
much as possible. However as one expects it is much easier to build a development
pipeline on top of a robust infrastructure.</p>
<p>The final part of the discussion on the accuracy of the development pipeline deals
with the relation between accuracy and the interaction of the tools and infrastructure.
The main issue with interaction issues is that they are often hard to understand
due to the, potentially large, number of components involved. Additionally certain
interaction issues may only occur under specific circumstances like high load or
specific times of the day / month / year, e.g. daylight savings or on leap days.</p>
<p>Because of the complexity it is important when building and maintaining a development pipeline
to following the normal development process, i.e. using version control,
(unit) testing, continuous integration, delivery or deployment, work item tracking
and extensive testing etc. for all changes to the pipeline. This applies to the scripts
and tools as well as the <a href="https://en.wikipedia.org/wiki/Infrastructure_as_Code">infrastructure</a>.
Additionally it is especially important to execute thorough regression testing for any change to the
pipeline to ensure that a change to a single part does not negatively influence the
correctness of the pipeline.</p>
<p>Finally in order to ensure that the correctness of the pipeline can be maintained, and improved
if required, it is sensible to provide monitoring of the pipeline and the underlying infrastructure
as well as ensuring that all parts of the pipeline are versioned, tools and infrastructure alike,
and versions of all the parts are tracked for each input set.</p>

                </div>
            </div>
        </div>
        <div id="post-spacer">
            <div id="post">
                <div id="post-header">
                    <!--
    Model is: Tuple<IDocument, IDocument>.
    The first one is the current document that is being rendered, the second one is the one for which the post header should be rendered.
-->


<h2>
            <a href="/posts/nBuildkit-Release-V0102">nBuildKit release - V0.10.2</a>
</h2>
<div id="post-meta">
    <p>
Monday, August 28, 2017
 |         Posted in                     <a id="post-category" role="button" href="/tags/nbuildkit" class="btn btn-default btn-xs">nBuildKit</a>
    </p>
</div>

                </div>
                <div id="post-content">
                    <p>Version <a href="https://github.com/nbuildkit/nBuildKit.MsBuild/releases/tag/0.10.2">0.10.2</a>
of <a href="https://github.com/nbuildkit/nBuildKit.MsBuild">nBuildKit</a>
has been released.</p>
<p>This release made the following minor changes</p>
<ul>
<li><a href="https://github.com/nbuildkit/nBuildKit.MsBuild/issues/316">Removed</a> the custom tasks assembly
from the <code>nBuildKit.MsBuild.Actions</code> NuGet package because those were never used from that package
as they are also in the <code>nBuildKit.MsBuild.Tasks</code> NuGet package</li>
<li>Added a deployment step to get <a href="https://github.com/nbuildkit/nBuildKit.MsBuild/issues/318">VCS information</a>
during the deploy process.</li>
<li>Fixed <a href="https://github.com/nbuildkit/nBuildKit.MsBuild/issues/317">missing bootstrap steps</a>
in the test and deploy stages.</li>
</ul>
<p>All the work items that have been closed for this release can be found on
github in the milestone list for the <a href="https://github.com/nbuildkit/nBuildKit.MsBuild/milestone/36?closed=1">0.10.2</a> release.</p>

                </div>
            </div>
        </div>
        <div id="post-spacer">
            <div id="post">
                <div id="post-header">
                    <!--
    Model is: Tuple<IDocument, IDocument>.
    The first one is the current document that is being rendered, the second one is the one for which the post header should be rendered.
-->


<h2>
            <a href="/posts/Software-development-pipeline-Design-introduction">Software development pipeline - Design introduction</a>
</h2>
<div id="post-meta">
    <p>
Monday, August 21, 2017
 |         Posted in                     <a id="post-category" role="button" href="/tags/delivering-software" class="btn btn-default btn-xs">Delivering software</a>
                    <a id="post-category" role="button" href="/tags/devops" class="btn btn-default btn-xs">DevOps</a>
                    <a id="post-category" role="button" href="/tags/pipeline-design" class="btn btn-default btn-xs">Pipeline design</a>
                    <a id="post-category" role="button" href="/tags/software-development-pipeline" class="btn btn-default btn-xs">Software development pipeline</a>
    </p>
</div>

                </div>
                <div id="post-content">
                    <p>In order to deliver new or improved software applications within the desired
time span while maintaining or improving quality modern development moves towards
<a href="https://techbeacon.com/doing-continuous-delivery-focus-first-reducing-release-cycle-times">shorter development and delivery</a>
cycles. This is often achieved through the use of agile processes and a development
workflow including <a href="https://en.wikipedia.org/wiki/Continuous_integration">Continuous Integration</a>,
<a href="https://en.wikipedia.org/wiki/Continuous_delivery">Continuous Delivery</a>
or even <a href="https://www.agilealliance.org/glossary/continuous-deployment">Continuous deployment</a>.</p>
<p>One of the consequences of this desire to reduce the development cycle time on the
development process is that more tasks in the development workflow
have to be automated in order to reduce the time taken for the specific task.
One way this automation can be achieved is by creating a
<a href="http://www.informit.com/articles/article.aspx?p=1621865&amp;seqNum=2">development pipeline</a> which
takes the source code and moves it through a set of largely automatic transformations, e.g. compilation,
testing, packaging and potentially deployment, to obtain a validated, and potentially deployed, application.</p>
<p>In order to configure a development pipeline, whether that is on-prem or in the cloud, for
one or more development teams one will have to understand what the requirements are which
are placed on the pipeline, which tooling is available to create the pipeline, whether the
pipeline will be situated on-prem, in the cloud or a combination and
how the pipeline will be assembled and managed. In this post series some of
these issues will be discussed starting with the requirements or considerations that need
to be given to the characteristics or behaviours of the development pipeline.</p>
<p>Prior to discussing what the considerations are for selecting tooling and infrastructure
for a development pipeline, it is important to decide what elements are part of the pipeline
and which elements are not. For the remainder of this
post series the development pipeline is considered to consist of:</p>
<ul>
<li>The scripts that are used during the different parts of the cycle, i.e. the build, test
and release scripts.</li>
<li>The continuous integration system which is used to execute the different scripts.</li>
<li>The tools, like the compiler, test frameworks, etc.</li>
</ul>
<p>Items like version control, package management, issue tracking, system monitoring,
customer support and others are not included in the discussion. While these systems
are essential in application development and deployment each of these systems spans
a large enough area that it warrants a more thorough discussion than can be given in
this post series.</p>
<p>Additionally, the following terms will be used throughout the series:</p>
<ul>
<li>Input set - A collection of information that is provided to the pipeline to start
the process of turning these generating the desired artefacts. An input set may consist
of source code, e.g. in terms of a given commit to the source control system, files or
documents, configuration values or any other combination of information which is required
to create, validate and deploy the product artefacts.
An input set should contain all the information needed to generate and deploy the product
artefacts and each time a specific input set is provided to the pipeline exactly the
same artefacts will be produced.</li>
<li>Executor - In general the development pipeline will be driven by a continuous integration
system which itself consists of a controlling unit, which receives the tasks and distributes them,
and a set of executing units which perform the actual computational tasks. In small systems
the controlling unit may also perform the computational tasks, however even in this case
a distinction can be made between the controlling and executing parts.</li>
</ul>
<p>In order to start the selection of suitable components for a development pipeline
it is important to know what the desirable properties of such a system are. The following
ordered properties are thought to be the most important ones to consider.</p>
<ul>
<li><a href="Software-development-pipeline-Design-accuracy.html">Accurate</a>: The pipeline must return the right
outputs for a specific input, i.e it should report errors to the interested parties if there are any
and report success and produce the desired artefacts if there are no errors.</li>
<li>Performance: The pipeline must push changes through the different stages fast
in order to get results back to the interested parties as soon as possible.</li>
<li>Robustness: The pipeline must be able to cope with environmental changes, both expected
and unexpected.</li>
<li>Flexibility: The pipeline must be easy to adapt to new products and tools so that it can
be used without having to replace large parts each time a new product or tool needs to
be included.</li>
</ul>
<p>There are of course other desirable properties for a development pipeline like ease-of-use,
maintainability, etc.. It is however considered that the aforementioned properties are the
most critical ones. The linked posts provide additional reasons why each of these properties
are important and how a software development pipeline can be designed to satisfy these important
considerations.</p>
<p>Additional posts about this topic can be found via the
<a href="/tags/software-development-pipeline.html">Software development pipeline</a> tag.</p>
<h4>Edits</h4>
<ul>
<li>August 30th: Replaced the term <code>correctness</code> with the term <code>accuracy</code> because that
is a better description of the combined concepts of consistency and correctness.</li>
<li>September 4th: Added the link to the post providing the high level description on
how to achieve accuracy for a development pipeline</li>
</ul>

                </div>
            </div>
        </div>
            </div>
        </div>

        <footer>
            <div id="footer" class="container">
    <div id="fbox1">
        <h2>Related</h2>
        <ul>
            <li id="first"><a href="https://plus.google.com/+PatrickvanderVelde/about"><i class="fa fa-google-plus"></i> Google+</a></li>
            <li><a href="https://github.com/pvandervelde"><i class="fa fa-github"></i> GitHub</a></li>
            <li><a href="http://www.linkedin.com/profile/view?id=33950311"><i class="fa fa-linkedin"></i> LinkedIn</a></li>
            <li><a href="http://stackoverflow.com/users/539846/petrik"><i class="fa fa-stack-overflow"></i> StackOverflow</a></li>
            <li><a href="http://careers.stackoverflow.com/pvandervelde"><i class="fa fa-stack-overflow"></i> StackOverflow Careers</a></li>
            <li><a href="https://twitter.com/petrikvdvelde"><i class="fa fa-twitter"></i> Twitter</a></li>
        </ul>
    </div>
    <div id="fbox2">
        <h2 id="copyright">Copyright</h2>
        <p>Copyright (c) 2017 <a href="/">Petrik van der Velde</a>. All rights reserved.</p>

        <h2 id="disclaimer">Disclaimer</h2>
        <p>The opinions expressed herein are my own personal opinions and do not represent my employer's view in any way.</p>
    </div>
    <div id="fbox3">
        <h2 id="media">Media</h2>
        <p><a href="/feed.atom"><img src="/assets/images/feed.png" alt="Atom feed"></a></p>
    </div>
</div>
<div id="copyright" class="container">
    <div>
        <p>
            Generated by <a href="https://wyam.io">Wyam</a> on Sun, 05 Nov 2017 00:11:23 GMT

 from commit <a href="https://github.com/pvandervelde/mindvortex/tree/d209900b6b626f98d2dd54b3ceb8e07084e20f7b">d209900b6b626f98d2dd54b3ceb8e07084e20f7b</a> at version 2.8.0.        </p>
    </div>

    <p>
        Site design based on the <a href="http://www.freecsstemplates.org/previews/opentools/">Open Tools</a> design
        by <a href="http://www.freecsstemplates.org">FreeCSSTemplates.org</a>.
    </p>
    <p>
        Feed icon by <a href="http://www.icojam.com/">Icojam</a> and Favicon by
        <a href="http://www.flaticon.com/free-icon/twister-sky-wind_12318" title="Yannick">Yannick</a>
        from <a href="http://www.flaticon.com" title="Flaticon">www.flaticon.com</a>
    </p>
</div>

        </footer>
    </body>
</html>
